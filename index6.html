<!DOCTYPE html>
<html lang="en">
<head>
        <title>charlesreid1</title>
        <meta charset="utf-8" />

        <!--
        CSS styles
        -->
        <link href="https://charlesreid1.github.io/theme/css/bootstrap.css"       rel="stylesheet" type="text/css">
        <link href="https://charlesreid1.github.io/theme/css/slate.css"              rel="stylesheet" type="text/css">
        <link href="https://charlesreid1.github.io/theme/css/font-awesome.css"       rel="stylesheet" type="text/css"/>
        <link href="https://charlesreid1.github.io/theme/css/pygment-solarized.css"  rel="stylesheet" type="text/css"/>

        <!--
        my CSS styles
        -->
        <link href="https://charlesreid1.github.io/theme/css/main.css"            rel="stylesheet" type="text/css">
        <link href="https://charlesreid1.github.io/theme/css/dox.css"             rel="stylesheet" type="text/css">


        <!--
        include Angular first
        -->
        <script type="text/javascript" src="https://charlesreid1.github.io/theme/js/angular-1.3.15.js"></script>
        <script type="text/javascript" src="https://charlesreid1.github.io/theme/js/skrollr-0.6.29.js"></script>
        <script type="text/javascript" src="https://charlesreid1.github.io/theme/js/d3-3.5.5.js"></script>

        <!--
        this seems like a bad idea.
        but if I don't put jquery first, I get errors about unrecognized $s.
        -->
        <script type="text/javascript" src="https://charlesreid1.github.io/theme/js/jquery-1.11.2.js"></script>

</head>
<body id="index">
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span> 
            </button>
            <a href="https://charlesreid1.github.io" class="navbar-brand">charlesreid1.github.io</a>
        </div>
        <div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav">

                    <li>
                        <a href="https://charlesreid1.com/wiki">Wiki</a>
                    </li>
                    <li>
                        <a href="https://git.charlesreid1.com/explore">Git</a>
                    </li>
                    <li>
                        <a href="http://spotify.charlesreid1.com">Music</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/life">Life</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.github.io">Blog</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/about">About Me</a>
                    </li>

                </ul>
            </div>
        </div>
    </div>
</nav>



<div class="container">

    <div class="row">
        <div class="col-md-12 col-centered" style="text-align: center;">
            <div class="v50"></div>
            <div class="cosmojumbo">
                <h1 class="jumbojumbo">charlesreid1.com blog<h1>
            </div>
        </div>
    </div>


    <div class="v50"></div>


    <div class="row">

        <div class="col-md-8" style="text-align: center;">

  	            	<article>
<header>
<div class="row">


    <div class="col-md-12">
        <div class="headtext" style="text-align: center;">
            <h1><b>
                Python: From Args to Kwargs
            </b></h1>
        
            <p class="lead">
                Posted 
                <time datetime="2020-02-25T16:00:00-08:00" pubdate>Tuesday 02/25/2020</time>
                in 
                <a href="https://charlesreid1.github.io/category/python.html">Python</a>
                </p>
            <p>
            <span style="font-size: 14px">
                <a href="https://charlesreid1.github.io/python-from-args-to-kwargs.html">permalink</a>
            </span>
            </p>
        </div>

    </div>

</div>
</header>


<div class="v50"></div>


<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="entry-content"><div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#the-easy-way-locals">The Easy Way: locals()</a></li>
<li><a href="#when-locals-wont-work-getting-a-method-signature-programmatically">When locals() Won't Work: Getting a Method Signature Programmatically</a></li>
<li><a href="#args-to-kwargs-parameter-extraction-from-decorator">Args to Kwargs: Parameter Extraction from Decorator</a></li>
</ul>
</div>
<h2 id="overview">Overview</h2>
<p>In this short blog post, we talk about how and when you can take a method signature
that defines input positional arguments by name, like this:</p>
<div class="highlight"><pre><span></span><code>def foo(arg1, arg2, arg3):
    pass
</code></pre></div>

<p>and write code that will return a dictionary containing a keyword arguments-like structure:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; foo(&#39;red&#39;, &#39;blue&#39;, &#39;green&#39;)
{
    &#39;arg1&#39;: &#39;red&#39;,
    &#39;arg2&#39;: &#39;blue&#39;,
    &#39;arg3&#39;: &#39;green&#39;
}
</code></pre></div>

<p>We will cover an example of writing a decorator that utilizes input arguments from both
the decorator and from the function it wraps, and how to keep all of that information
straight.</p>
<h2 id="the-easy-way-locals">The Easy Way: <code>locals()</code></h2>
<p>We'll start with the easiest possible wyay to turn args into kwargs: <code>locals()</code>. The <code>locals()</code>
function is one of the built-in methods provided by Python:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; print(help(locals))

Help on built-in function locals in module builtins:

locals()
    Return a dictionary containing the current scope&#39;s local variables.

    NOTE: Whether or not updates to this dictionary will affect name lookups in
    the local scope and vice-versa is *implementation dependent* and not
    covered by any backwards compatibility guarantees.
</code></pre></div>

<p>This is a straightforward way to get a dictionary of input argument names mapping to
the values provided by the user:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; def foo(arg1, arg2, arg3):
...     print(locals())
...
&gt;&gt;&gt; foo(&#39;asdf&#39;, &#39;qwerty&#39;, &#39;oioioioi&#39;)
{&#39;arg3&#39;: &#39;oioioioi&#39;, &#39;arg2&#39;: &#39;qwerty&#39;, &#39;arg1&#39;: &#39;asdf&#39;}
</code></pre></div>

<h2 id="when-locals-wont-work-getting-a-method-signature-programmatically">When <code>locals()</code> Won't Work: Getting a Method Signature Programmatically</h2>
<p>Sometimes, <code>locals()</code> won't get you what you need - like when you're decorating a function,
and you don't have the original method signature.</p>
<p>In that case, you can still use a function handle and get the original positional argument
names from the function signature.</p>
<p>In Python, the signature of a method can be obtained using the <code>inspect</code> module's
<code>signature()</code> method, which can be passed a function:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; import inspect
&gt;&gt;&gt; def foo(arg1, arg2, arg3):
...      pass
...
&gt;&gt;&gt; print(inspect.signature(foo))
(arg1, arg2, arg3)
</code></pre></div>

<p>The <code>_parameters</code> attribute of the signature will yield an ordered list of parameters in the
method signature, which is equivalent to the variable names that are used in the method
definition (<code>arg1</code>, <code>arg2</code>, and <code>arg3</code> in the example <code>foo()</code> function above):</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; print(list(inspect.signature(foo)._parameters))
[&#39;arg1&#39;, &#39;arg2&#39;, &#39;arg3&#39;]
</code></pre></div>

<h2 id="args-to-kwargs-parameter-extraction-from-decorator">Args to Kwargs: Parameter Extraction from Decorator</h2>
<p>We can use this to get the original variable names from a function handle, even if we don't
have its original method signature (i.e., if we're a decorator and are just passed the function).</p>
<p>Here is an example of a decorator that extracts positional arguments from the function it
decorates (and prints them out!):</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">inspect</span>

<span class="k">def</span> <span class="nf">real_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># This is where the interesting stuff starts!</span>
        <span class="c1"># We have a handle to a function that we&#39;re</span>
        <span class="c1"># decorating, but we don&#39;t have its original</span>
        <span class="c1"># method signature.</span>
        <span class="c1"># No sweat. Turn positional args into augmented</span>
        <span class="c1"># kwargs!</span>
        <span class="n">func_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">_parameters</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">func_kwargs</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="c1"># Unspecified positional argument</span>
                <span class="c1"># (using default value)</span>
                <span class="k">pass</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;wrapper extracted the following params: </span><span class="si">{</span><span class="n">func_kwargs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrapper</span>

<span class="c1"># don&#39;t forget to top it off</span>
<span class="c1"># by decorating a simple function</span>
<span class="c1"># and calling it if script is run</span>
<span class="nd">@real_decorator</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hello world!&quot;</span><span class="p">)</span>

<span class="k">if</span>  <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">foo</span><span class="p">(</span><span class="s1">&#39;asdf&#39;</span><span class="p">,</span> <span class="s1">&#39;qwerty&#39;</span><span class="p">,</span> <span class="s1">&#39;wioioioio&#39;</span><span class="p">)</span>
</code></pre></div>

<p>And when run, the result is:</p>
<div class="highlight"><pre><span></span><code>$ py five.py
wrapper extracted the following params: {&#39;arg1&#39;: &#39;asdf&#39;, &#39;arg2&#39;: &#39;qwerty&#39;, &#39;arg3&#39;: &#39;wioioioio&#39;}
hello world!
</code></pre></div></div>

    </div>
</div>

<div class="v20"></div>

<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="tags">
            <p>Tags:&nbsp;&nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/python.html">python</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/programming.html">programming</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/arguments.html">arguments</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/functions.html">functions</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/methods.html">methods</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/parameters.html">parameters</a>
                    &nbsp;&nbsp;
        </div>

    </div>
</div>


<div class="v200"></div>
  	            	</article>
  	            	<article>
<header>
<div class="row">


    <div class="col-md-12">
        <div class="headtext" style="text-align: center;">
            <h1><b>
                Confuse-A-Constructor: When Class A's Constructor Returns Objects of Type B
            </b></h1>
        
            <p class="lead">
                Posted 
                <time datetime="2020-02-22T13:00:00-08:00" pubdate>Saturday 02/22/2020</time>
                in 
                <a href="https://charlesreid1.github.io/category/python.html">Python</a>
                </p>
            <p>
            <span style="font-size: 14px">
                <a href="https://charlesreid1.github.io/confuse-a-constructor-when-class-as-constructor-returns-objects-of-type-b.html">permalink</a>
            </span>
            </p>
        </div>

    </div>

</div>
</header>


<div class="v50"></div>


<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="entry-content"><div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#confuse-a-constructor">Confuse-A-Constructor</a></li>
<li><a href="#what-is-the-constructor">What is the constructor?</a></li>
<li><a href="#rewiring-the-constructor-to-do-weird-stuff">Rewiring the constructor to do... weird stuff</a></li>
<li><a href="#a-simple-example-class">A simple example class</a></li>
<li><a href="#adding-a-__new__-method">Adding a __new__ method</a></li>
<li><a href="#when-__new__-returns-objects-not-classes">When __new__ returns objects, not classes</a></li>
<li><a href="#moving-beyond-argparse">Moving beyond argparse</a></li>
<li><a href="#using-__new__-in-your-patterns">Using __new__ in your patterns</a></li>
</ul>
</div>
<h2 id="confuse-a-constructor">Confuse-A-Constructor</h2>
<p>Today, we are going to confuse a constructor.</p>
<iframe allowFullScreen="allowFullScreen" src="https://www.youtube.com/embed/1tsIxNci_dE?ecver=1&amp;iv_load_policy=1&amp;rel=0&amp;yt:stretch=16:9&amp;autohide=1&amp;color=red&amp;width=560&amp;width=560" width="560" height="315" allowtransparency="true" frameborder="0">
    <script type="text/javascript">function execute_YTvideo(){return youtube.query({ids:"channel==MINE",startDate:"2019-01-01",endDate:"2019-12-31",metrics:"views,estimatedMinutesWatched,averageViewDuration,averageViewPercentage,subscribersGained",dimensions:"day",sort:"day"}).then(function(e){},function(e){console.error("Execute error",e)})}</script>
</iframe>

<h2 id="what-is-the-constructor">What is the constructor?</h2>
<p>One of the first concepts encountered in object-oriented programming
is that of the <em>constructor</em>, the method that is run immediately after
an object is instantiated that configures and initializes the object.</p>
<p>In Python, a constructor is defined by the <code>__init__</code> function.
The constructor is not permitted to return a value, because
constructing a new instance of class A should result in an object
of type A. Returning something would just be confusing things.</p>
<p>But does it ever make sense for a constructor of class A to return
an object of type B? And if it does make sense, how do we go about
doing it?</p>
<h2 id="rewiring-the-constructor-to-do-weird-stuff">Rewiring the constructor to do... weird stuff</h2>
<p>The answer lies in Python's <code>__new__</code> method, which is a method called
when a class is defined (not instantiated). The <code>__new__</code> method is
different from the <code>__init__</code> method, and does not do the same thing.</p>
<p>The <code>__new__</code> method for class A should only return the type of class A.
If <code>__new__</code> returns anything else, Python will not run the <code>__init__</code>
method for class A.</p>
<p>For example, suppose we want a wrapper class that transparently constructs
different kinds of objects conditionally - based on a configuration file,
or the state of a file, or some other condition. We want to construct an
object of type A and get back an object of type B, C, or D. How to do that?</p>
<p>First, let's look at how the <code>__new__</code> method works.</p>
<h2 id="a-simple-example-class">A simple example class</h2>
<p>Start with a simple example class:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Instance of class A created&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello world&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Executing this gives:</p>
<div class="highlight"><pre><span></span><code>In [3]: my_object = A()
Instance of class A created

In [4]: my_object.hello()
Hello world
</code></pre></div>

<h2 id="adding-a-__new__-method">Adding a <code>__new__</code> method</h2>
<p>Now let's look at a class A where we define the <code>__new__</code> method. This method
controls how the instantiation of objects of type A work, so we can do something
like limiting the creation of objects of type A to when a certain condition is
met:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">tossCoin</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="k">class</span> <span class="nc">A5050</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tossCoin</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Count not create instance&quot;</span><span class="p">)</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">A5050</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">instance</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Instance of class A5050 created&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello world&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Now we can run this block of code:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_a5050</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">my_object</span> <span class="o">=</span> <span class="n">A5050</span><span class="p">()</span>
        <span class="n">my_object</span><span class="o">.</span><span class="n">hello</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Better luck next time!&quot;</span><span class="p">)</span>
</code></pre></div>

<p>It takes a few tries:</p>
<div class="highlight"><pre><span></span><code>In [9]: make_a5050()
Better luck next time!

In [10]: make_a5050()
Instance of class A5050 created
Hello world
</code></pre></div>

<p>The <code>__new__</code> method for the <code>A5050</code> class raises a runtime error
with a 50% probability. Otherwise, it calls the <code>__new__</code> method
of the parent class (<code>object</code>, which returns a class of type <code>object</code>).
We pass the same arguments and keyword arguments (args/kwargs) on to the
super class <code>__new__</code>, but we could optionally modify them here (say, add
a keyword, or check the state of a file, or etc.).</p>
<p>This is just an example of how the instantiation behavior of a class
can be modified before its constructor is even called by using the
<code>__new__</code> method.</p>
<h2 id="when-__new__-returns-objects-not-classes">When <code>__new__</code> returns objects, not classes</h2>
<p>In the above example, our <code>__new__</code> method returned the result of
a call to <code>__new__</code> of a parent class. What happens if <code>__new__</code>
returns something else?</p>
<p>First, repeating an important point made above: if <code>__new__</code> for a class
returns anything <em>other</em> than that class type, then <code>__init__</code> will not 
be called for that class.</p>
<p>That means that the <code>__new__</code> method should <em>either</em> return a class (if
returning the type of its parent class, like a normal <code>__new__</code> method
does), <em>or</em> it should return an instantiated object.</p>
<p>Let's imagine that we want to create different instances of different
classes based on a command line flag passed to the script:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">BaseClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello world from class </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">BaseClass</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">BaseClass</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">BaseClass</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">B</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">B</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">C</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">C</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">D</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">D</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Could not create instance&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">argparse</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-B&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Return object of type B&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-C&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Return object of type C&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-D&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Return object of type D&#39;</span><span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</code></pre></div>

<p>Now if we run this script and pass it different flags, we get
a variable <code>a</code> with different types:</p>
<div class="highlight"><pre><span></span><code>$ py wat2.py -h
usage: wat2.py [-h] [-B] [-C] [-D]

optional arguments:
  -h, --help  show this help message and exit
  -B          Return object of type B
  -C          Return object of type C
  -D          Return object of type D
</code></pre></div>

<p>Now try the three flags:</p>
<div class="highlight"><pre><span></span><code>$ py wat2.py -B
&lt;class &#39;__main__.B&#39;&gt;

$ py wat2.py -C
&lt;class &#39;__main__.C&#39;&gt;

$ py wat2.py -D
&lt;class &#39;__main__.D&#39;&gt;
</code></pre></div>

<h2 id="moving-beyond-argparse">Moving beyond argparse</h2>
<p>The example above shows how the constructor can use
argparse options to determine what kind of object
to return with <code>__new__</code>, but you can use other
types of conditions as well:</p>
<ul>
<li>using command line options (see argparse example above)</li>
<li>using configuration file options</li>
<li>using environment variable values</li>
<li>checking status of a file or port</li>
<li>checking whether internet connection is available</li>
</ul>
<h2 id="using-__new__-in-your-patterns">Using <code>__new__</code> in your patterns</h2>
<p>We have already covered the <a href="#">Registry</a>
pattern in a prior blog post, but the
<code>__new__</code> method lends itself well to
all kinds of other patterns, including the
Singleton pattern and the Factory pattern.</p>
<p>There are some very useful patterns covered
in this Github repository: <a href="https://github.com/faif/python-patterns">https://github.com/faif/python-patterns</a></p></div>

    </div>
</div>

<div class="v20"></div>

<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="tags">
            <p>Tags:&nbsp;&nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/python.html">python</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/constructor.html">constructor</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/computer-science.html">computer science</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/object-oriented-programming.html">object oriented programming</a>
                    &nbsp;&nbsp;
        </div>

    </div>
</div>


<div class="v200"></div>
  	            	</article>
  	            	<article>
<header>
<div class="row">


    <div class="col-md-12">
        <div class="headtext" style="text-align: center;">
            <h1><b>
                Python Patterns: The Registry
            </b></h1>
        
            <p class="lead">
                Posted 
                <time datetime="2020-02-20T22:22:00-08:00" pubdate>Thursday 02/20/2020</time>
                in 
                <a href="https://charlesreid1.github.io/category/python.html">Python</a>
                </p>
            <p>
            <span style="font-size: 14px">
                <a href="https://charlesreid1.github.io/python-patterns-the-registry.html">permalink</a>
            </span>
            </p>
        </div>

    </div>

</div>
</header>


<div class="v50"></div>


<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="entry-content"><div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#what-is-the-registry-pattern">What is the Registry Pattern?</a><ul>
<li><a href="#the-registry-base-type">The Registry Base Type</a></li>
<li><a href="#the-base-registered-class">The Base Registered Class</a></li>
<li><a href="#extending-the-base-registered-class">Extending the Base Registered Class</a></li>
<li><a href="#seeing-it-in-action">Seeing it in action</a></li>
</ul>
</li>
<li><a href="#examples">Examples</a><ul>
<li><a href="#example-search-engine">Example: Search Engine</a><ul>
<li><a href="#registry-subclasses">Registry Subclasses</a></li>
<li><a href="#doctype-registry-base-type">Doctype Registry Base Type</a></li>
<li><a href="#base-registered-doctype-class">Base Registered Doctype Class</a></li>
<li><a href="#derived-registered-doctype-class">Derived Registered Doctype Class</a></li>
<li><a href="#using-the-registry">Using the Registry</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#further-modifications">Further Modifications</a></li>
<li><a href="#summary">Summary</a></li>
</ul>
</div>
<h1 id="overview">Overview</h1>
<p>This post is a summary of a useful Python programming pattern called the Registry pattern.</p>
<p>The Registry pattern is a way of keeping track of all subclasses of a given class.</p>
<p>More details about this pattern are available at <a href="https://github.com/faif/python-patterns">https://github.com/faif/python-patterns</a>.</p>
<h1 id="what-is-the-registry-pattern">What is the Registry Pattern?</h1>
<p>Let's start with a common scenario: you have some kind of manager class that is
managing multiple related subclasses, and you are looking for a simpler way to
manage the subclasses.</p>
<p>The registry pattern creates a map of labels to class types, and allows you to
access a single registry common to all of those classes. The registry is updated
every time a new class is added.</p>
<p>This is useful for several situations, including these two examples:</p>
<ul>
<li>You want the manager class to iterate over every available subclass and call a
  particular method on each subclass</li>
<li>You want to streamline a factory class, which takes an input label (like the name
  of a class) and creates/returns an object of that type</li>
</ul>
<h2 id="the-registry-base-type">The Registry Base Type</h2>
<p>We start by defining a registry base type (or class). This class defines one behavior,
which is adding itself to the class registry. It creates a shared instance variable called
<code>REGISTRY</code> which is shared amongst all of the classes, and is also accessible via a class
method.</p>
<p>This is the base class; any class we want registered should inherit from this class.
It should also extend the <code>type</code> class, since it is itself a class type:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">RegistryBase</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>

    <span class="n">REGISTRY</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="c1"># instantiate a new type corresponding to the type of class being defined</span>
        <span class="c1"># this is currently RegisterBase but in child classes will be the child class</span>
        <span class="n">new_cls</span> <span class="o">=</span> <span class="nb">type</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">REGISTRY</span><span class="p">[</span><span class="n">new_cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_cls</span>
        <span class="k">return</span> <span class="n">new_cls</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_registry</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">REGISTRY</span><span class="p">)</span>
</code></pre></div>

<p>The design here is subtle, but the details are important to understand how it works.</p>
<p>A few important things to note, progressing from top to bottom:</p>
<ul>
<li>
<p>The <code>REGISTRY</code> variable is defined outside the scope of any class methods, meaning it is a
  shared instance variable (a variable that is shared across all instances of <code>RegistryBase</code>);
  this is an example of the Borg pattern.</p>
</li>
<li>
<p>The <code>RegistryBase</code> class defines <code>__new__</code>, not <code>__init__</code>; the <code>__new__</code> method is run when
  the class is defined, while <code>__init__</code> is run when the classs is instantiated. This ensures
  that any subclasses that inherit from <code>RegistryBase</code> add themselves to the registry when they
  are defined, not when they are instantiated.</p>
</li>
<li>
<p>In the constructor, we store a reference to the current class using this line:</p>
</li>
</ul>
<p><code>new_cls = type.__new__(cls, name, bases, attrs)</code></p>
<p>This creates a new class, but of type <code>type</code> (confusing, but basically it means we store
  a reference to this <em><strong>type</strong></em> of object, not just a reference to a particular object).</p>
<p>It is important to note that once we use the registry, the value that is returned is callable,
  and will create an object corresponding to that type.</p>
<ul>
<li>We define a <code>get_registry</code> method to return a copy of the registry; this must be decorated with
  a <code>@classmethod</code> decorator (not a <code>@staticmethod</code> decorator) so that it has access to the registry,
  which is a class instance variable.</li>
</ul>
<p><strong>BONUS NOTE:</strong> From prior experience, we have found it easiest to ignore the case of the
label (uppercase, lowercase, CamelCase, etc) and convert all class names to lowercase in the
registry:</p>
<div class="highlight"><pre><span></span><code>        <span class="bp">cls</span><span class="o">.</span><span class="n">REGISTRY</span><span class="p">[</span><span class="n">new_cls</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">new_cls</span>
</code></pre></div>

<h2 id="the-base-registered-class">The Base Registered Class</h2>
<p>Now we can define a base class that will extend the <code>RegistryBase</code> class. However, because <code>RegistryBase</code>
is a <code>type</code> class, we shouldn't extend it directly - we should use it as a <em>metaclass</em>.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">BaseRegisteredClass</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">RegistryBase</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>

<p>Any class that inherits from this <code>BaseRegisteredClass</code> will now be included in the registry when it is
defined.</p>
<h2 id="extending-the-base-registered-class">Extending the Base Registered Class</h2>
<p>The next step is to use the base registered class to start creating interesting classes:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ExtendedRegisteredClass</span><span class="p">(</span><span class="n">BaseRegisteredClass</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span>
</code></pre></div>

<p>We skip defining constructor behavior, as the call order is what's important.</p>
<h2 id="seeing-it-in-action">Seeing it in action</h2>
<p>Now we can see the process of adding subclasses to the registry in action.</p>
<p>Start by checking the registry before we have created any subclasses:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; print(RegistryHolder.REGISTRY)
[&#39;BaseRegisteredClass&#39;]
</code></pre></div>

<p>Next, define the extended registered class:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class ExtendedRegisteredClass(BaseRegisteredClass):
...     def __init__(self, *args, **kwargs):
...         pass
</code></pre></div>

<p>Remember, we add the new class to the registry in the <code>__new__</code> method, not the
<code>__init__</code> method, so we don't even need to instantiate an <code>ExtendedRegisteredClass</code>
object for it to be added to the registry. Check the registry again:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; print(RegistryHolder.REGISTRY)
[&#39;BaseRegisteredClass&#39;, &#39;ExtendedRegisteredClass&#39;]
</code></pre></div>

<h1 id="examples">Examples</h1>
<p>Let's consider a specific example to help illustrate the usefulness of the Registry pattern:
adding the ability to index different kinds of documents to a search engine.</p>
<h2 id="example-search-engine">Example: Search Engine</h2>
<p>Suppose we are writing a search engine, and we are working on the search engine
backend. Specifically, consider the backend portion that iterates over a group of
documents, checks if the document is already in the search index, and either adds
a new item to the search index, updates an existing item in the search index, or
deletes an item from the search index.</p>
<h3 id="registry-subclasses">Registry Subclasses</h3>
<p>A search engine may index multiple kinds of documents, each living in different locations.
For example, a search index may index .docx files in a Google Drive folder,
Github issues, and/or a local folder full of Markdown files. For each of these
document types, we must define:</p>
<ul>
<li>
<p>How to add or update all documents in the document storage system (Google Drive, Github
  API, local filesystem, etc.); this method should be able to get a list of documents of this
  document type that are already in the search index, either by running a query itself, or by
  accepting a list of documents already in the index as an input argument</p>
</li>
<li>
<p>What schema to use (mapping various field names to data types) for documents of this type</p>
</li>
<li>
<p>How to display search results when they are documents of this type (i.e., how to display
  what fields when showing the user search results)</p>
</li>
</ul>
<p>This can be done by defining classes corresponding to different document types, where
each class defines how to do the above actions, and wraps them in high-level API methods
that the manager classes can call.</p>
<p>The manager classes want a way to get a list of available document types, and to call
each document type's high-level API methods. This can be done with the registry.</p>
<h3 id="doctype-registry-base-type">Doctype Registry Base Type</h3>
<p>Start by defining a base type that will register new subclasses in a doctype registry. Note that
as per the <a href="https://docs.python.org/3/reference/datamodel.html#object.__new__"><code>__new__</code> documentation</a>,
the <code>__new__</code> method takes the class (in our case, a class of type <code>type</code>) as the first argument <code>cls</code>,
and it should return a new object instance (which, again, is an instance of type <code>type</code>).</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">DoctypeRegistryBase</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>

    <span class="n">DOCTYPE_REGISTRY</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="n">new_cls</span> <span class="o">=</span> <span class="nb">type</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">DOCTYPE_REGISTRY</span><span class="p">[</span><span class="n">new_cls</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">new_cls</span>
        <span class="k">return</span> <span class="n">new_cls</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_doctype_registry</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">DOCTYPE_REGISTRY</span><span class="p">)</span>
</code></pre></div>

<h3 id="base-registered-doctype-class">Base Registered Doctype Class</h3>
<p>Next, we define a base class for any document type that we want registered in the doctype
registry, using <code>DoctypeRegistryBase</code> as our metaclass (because it is a class of type <code>type</code>,
as opposed to a normal class).  All document types are required to define three bits of behavior
(interacting with the document storage system to iterate over all documents; extracting information
from individual documents; and displaying a given document type when it is a search result. We
define these virtual methods on the base registered doctype class.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">BaseRegisteredDoctypeClass</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">DoctypeRegistryBase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">add_update_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterate over all documents in the document storage system</span>
<span class="sd">        and add/update/delete documents as needed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assemble and return the schema (map of field names to data types)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">render_search_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use a Jinja template to render a single search result of type doctype</span>
<span class="sd">        to display to the user via the web interface</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

<h3 id="derived-registered-doctype-class">Derived Registered Doctype Class</h3>
<p>Now that we have a base class, we can define child classes that have the specific
API functionality needed.</p>
<p>Here is a high-level sketch of what the Github issue document type class might look like,
starting with the add/update/delete method, which boils down to some set operations to determine
what documents to add, update, or delete from the search index.</p>
<p>(Also note, these methods are defined as class methods because they are called once for each
doctype class, but this does not necessarily need to be the case.)</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GithubIssueDoctype</span><span class="p">(</span><span class="n">BaseRegisteredDoctypeClass</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_update_delete</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Get set of indexed document IDs</span>
        <span class="n">indexed_docs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">run_search_index_query</span><span class="p">(</span><span class="n">doctype</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">indexed_docs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="c1"># Get set of remote document IDs</span>
        <span class="n">remote_docs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">org_name</span> <span class="ow">in</span> <span class="n">get_org_names</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">repo_name</span> <span class="ow">in</span> <span class="n">get_repo_names</span><span class="p">(</span><span class="n">org_name</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">get_repo_files</span><span class="p">(</span><span class="n">repo_name</span><span class="p">,</span> <span class="n">org_name</span><span class="p">):</span>
                    <span class="n">remote_docs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="c1"># Do some set math to figure out what to add/update/delete</span>
        <span class="n">add_ids</span> <span class="o">=</span> <span class="n">remote_docs</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">indexed_docs</span><span class="p">)</span>
        <span class="n">update_ids</span> <span class="o">=</span> <span class="n">indexed_docs</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">remote_docs</span><span class="p">)</span>
        <span class="n">delete_ids</span> <span class="o">=</span> <span class="n">indexed_docs</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">remote_docs</span><span class="p">)</span>

        <span class="c1"># Do the operations</span>
        <span class="k">for</span> <span class="n">add_id</span> <span class="ow">in</span> <span class="n">add_ids</span><span class="p">:</span>
            <span class="n">add_document_to_index</span><span class="p">(</span><span class="n">add_id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">update_id</span> <span class="ow">in</span> <span class="n">update_ids</span><span class="p">:</span>
            <span class="n">update_document_in_index</span><span class="p">(</span><span class="n">update_id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">delete_id</span> <span class="ow">in</span> <span class="n">delete_ids</span><span class="p">:</span>
            <span class="n">delete_document_in_index</span><span class="p">(</span><span class="n">delete_id</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_schema</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">render_search_result</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="o">...</span>
</code></pre></div>

<p>Now we do the same for documents on Google Drive, defining a different <code>add_update_delete()</code> method
specific to Google Drive documents (note that while the sketch of this method looks similar to the
Github doctype above, the implementation will look more and more different as we include more and more
detail in our method and API calls).</p>
<p>As before, we make these methods class methods.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GoogleDocsDoctype</span><span class="p">(</span><span class="n">BaseRegisteredDoctypeClass</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_update_delete</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Get set of indexed document IDs</span>
        <span class="n">indexed_dcos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">run_search_index_query</span><span class="p">(</span><span class="n">doctype</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">indexed_docs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="c1"># Get set of remote document IDs</span>
        <span class="n">remote_docs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">get_gdrive_file_list</span><span class="p">():</span>
            <span class="n">remote_docs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="c1"># Do some math to figure out what to add/update/delete</span>
        <span class="n">add_ids</span> <span class="o">=</span> <span class="n">remote_docs</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">indexed_docs</span><span class="p">)</span>
        <span class="n">update_ids</span> <span class="o">=</span> <span class="n">indexed_docs</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">remote_docs</span><span class="p">)</span>
        <span class="n">delete_ids</span> <span class="o">=</span> <span class="n">indexed_docs</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">remote_docs</span><span class="p">)</span>

        <span class="c1"># Do the operations</span>
        <span class="k">for</span> <span class="n">add_id</span> <span class="ow">in</span> <span class="n">add_ids</span><span class="p">:</span>
            <span class="n">add_document_to_index</span><span class="p">(</span><span class="n">add_id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">update_id</span> <span class="ow">in</span> <span class="n">update_ids</span><span class="p">:</span>
            <span class="n">update_document_in_index</span><span class="p">(</span><span class="n">update_id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">delete_id</span> <span class="ow">in</span> <span class="n">delete_ids</span><span class="p">:</span>
            <span class="n">delete_document_in_index</span><span class="p">(</span><span class="n">delete_id</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_schema</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">render_search_result</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="o">...</span>
</code></pre></div>

<h3 id="using-the-registry">Using the Registry</h3>
<p>The last step is to actually use the registry from the class that manages all of our subclasses.
In this case, we have a <code>Search</code> class that defines high-level operations (such as, "add/update/delete
all documents indexed by this search engine") and in turn calls the corresponding method for each doctype
that has been registered.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Search</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">add_update_delete_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># Iterate over every doc type</span>
        <span class="k">for</span> <span class="n">doctype_name</span> <span class="ow">in</span> <span class="n">DoctypeRegistryBase</span><span class="o">.</span><span class="n">DOCTYPE_REGISTRY</span><span class="p">:</span>

            <span class="c1"># Get a handle to the doctype class</span>
            <span class="n">doctype_class</span> <span class="o">=</span> <span class="n">DoctypeRegistryBase</span><span class="o">.</span><span class="n">DOCTYPE_REGISTRY</span><span class="p">[</span><span class="n">doctype_name</span><span class="p">]</span>

            <span class="c1"># Call the class method add_update_delete on the doctype class</span>
            <span class="n">doctype_class</span><span class="o">.</span><span class="n">add_update_delete</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># Note: if we need to create an instance first</span>
            <span class="c1"># doctype_instance = doctype_class()</span>
            <span class="c1"># doctype_instance.add_update_delete(*args, **kwargs)</span>
</code></pre></div>

<h1 id="further-modifications">Further Modifications</h1>
<p>In the example above, we don't have any need to create specific instances of the document type classes,
since they do not need to preserve their state between calls, and we only need one instance of the doctype
class per search engine.</p>
<p>We could re-implement this pattern, modifying the search engine doctype classes to be normal, non-static
classes. This would allow us to have, say, two instances of the Github issues doctype class (corresponding
to two different sets of Github API credentials, or two different Github accounts), or two instances of the
Google Drive doctype class (corresponding to two different Google Drive folders). In this case, we would
want to restructure the Search class to instantiate and save doctype class instances in the constructor,
and use them later.</p>
<p>Here's an example <code>Search</code> class that would instantiate one of each subclass in the constructor, to be used
in later methods:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Search</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># Store instances of each doctype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_doctypes</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Iterate over every doc type</span>
        <span class="k">for</span> <span class="n">doctype_name</span> <span class="ow">in</span> <span class="n">DoctypeRegistryBase</span><span class="o">.</span><span class="n">DOCTYPE_REGISTRY</span><span class="p">:</span>

        <span class="c1"># Get a handle to the doctype class</span>
        <span class="n">doctype_class</span> <span class="o">=</span> <span class="n">DoctypeRegistryBase</span><span class="o">.</span><span class="n">DOCTYPE_REGISTRY</span><span class="p">[</span><span class="n">doctype_name</span><span class="p">]</span>

        <span class="c1"># Create an instance of type doctype_class</span>
        <span class="n">doctype_instance</span> <span class="o">=</span> <span class="n">doctype_class</span><span class="p">()</span>

        <span class="c1"># Save for later</span>
        <span class="n">all_doctypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">doctype_instance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_update_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># Call the add_update_delete method on each doctype instance</span>
        <span class="k">for</span> <span class="n">doctype_name</span><span class="p">,</span> <span class="n">doctype_instance</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_doctypes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">doctype_instance</span><span class="o">.</span><span class="n">add_update_delete</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

<p>(Note that this would work best if we removed the <code>@classmethod</code> decorators from the doctype classes
defined above.)</p>
<h1 id="summary">Summary</h1>
<p>In this post, we covered a useful programming pattern, the Registry, and showed it in action for one
example - allowing a search engine index to register various document type subclasses, then use those
registered subclasses to propagate calls to all document types later.</p></div>

    </div>
</div>

<div class="v20"></div>

<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="tags">
            <p>Tags:&nbsp;&nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/python.html">python</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/programming.html">programming</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/patterns.html">patterns</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/design-patterns.html">design patterns</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/registry.html">registry</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/computer-science.html">computer science</a>
                    &nbsp;&nbsp;
        </div>

    </div>
</div>


<div class="v200"></div>
  	            	</article>

<div class="row">
    <div class="col-md-4 col-centered" style="text-align: center;">

        <div class="pagination">

            <a class="next" href="https://charlesreid1.github.io/index5.html">&larr; Newer</a>

            &nbsp;
            &nbsp;
            &nbsp;
            &nbsp;
            &nbsp;

            <a class="prev" href="https://charlesreid1.github.io/index7.html">Older &rarr;</a>
        
          <br />
        </div>

    </div>
</div>

<div class="v50"></div>


        </div>

        <div class="col-md-4" style="text-align: center;">
<a name="a_archive"></a>


        <div class="well">

            <h2>March 2022</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/how-to-read-ulysses.html">How to Read Ulysses</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>February 2022</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/mediawiki-patterns-for-a-zettelkasten-todo-lists.html">MediaWiki Patterns for a Zettelkasten: Todo Lists</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/mediawiki-patterns-for-a-zettelkasten-organizing-pages.html">MediaWiki Patterns for a Zettelkasten: Organizing Pages</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>January 2022</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/mediawiki-patterns-for-a-zettelkasten-monthly-template-pattern.html">MediaWiki Patterns for a Zettelkasten: Monthly Template Pattern</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/mediawiki-patterns-for-a-zettelkasten-daily-page-pattern.html">MediaWiki Patterns for a Zettelkasten: Daily Page Pattern</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/using-mediawiki-as-a-zettelkasten-or-external-brain.html">Using MediaWiki as a Zettelkasten or External Brain</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>December 2021</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/september-2021-tils.html">September 2021 TILs</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/august-2021-tils.html">August 2021 TILs</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/july-2021-tils.html">July 2021 TILs</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/june-2021-tils.html">June 2021 TILs</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>August 2020</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/copying-letsencrypt-certs-between-machines.html">Copying LetsEncrypt Certs Between Machines</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>July 2020</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/applied-gitflow.html">Applied Gitflow</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>April 2020</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/a-singleton-configuration-class-in-python.html">A Singleton Configuration Class in Python</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>March 2020</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/using-mock-api-servers.html">Using Mock API Servers</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>February 2020</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/creating-mock-api-servers.html">Creating Mock API Servers</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/python-from-args-to-kwargs.html">Python: From Args to Kwargs</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/confuse-a-constructor-when-class-as-constructor-returns-objects-of-type-b.html">Confuse-A-Constructor: When Class A's Constructor Returns Objects of Type B</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/python-patterns-the-registry.html">Python Patterns: The Registry</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/incorporating-terraform-commands-into-makefiles.html">Incorporating Terraform Commands into Makefiles</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>December 2019</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/automatically-generating-up-to-date-requirementstxt-for-python-projects.html">Automatically Generating Up-To-Date requirements.txt for Python Projects</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/git-workflows-part-3-refactoring-large-branches-and-pull-requests.html">Git Workflows, Part 3: Refactoring Large Branches and Pull Requests</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>November 2019</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/git-workflows-part-2-crafting-commits.html">Git Workflows, Part 2: Crafting Commits</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>October 2019</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/git-workflows-part-1-supercharging-your-git-config.html">Git Workflows, Part 1: Supercharging your Git Config</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>September 2019</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/mocking-aws-in-unit-tests.html">Mocking AWS in Unit Tests</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>May 2019</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/deconvoluting-convolutional-neural-networks.html">Deconvoluting Convolutional Neural Networks</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/graphs-for-bioinformatics-part-2-finding-eulerian-paths.html">Graphs for Bioinformatics, Part 2: Finding Eulerian Paths</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/graphs-for-bioinformatics-part-1-de-bruijn-graphs-hamiltonian-paths-and-eulerian-paths.html">Graphs for Bioinformatics, Part 1: de Bruijn Graphs, Hamiltonian Paths, and Eulerian Paths</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>April 2019</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/the-git-commit-ectomy.html">The Git-Commit-Ectomy</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>March 2019</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/the-josephus-problem-part-3-solving-the-double-step-case.html">The Josephus Problem: Part 3: Solving the Double Step Case</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/the-josephus-problem-part-2-two-examples.html">The Josephus Problem: Part 2: Two Examples</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/the-josephus-problem-part-1-the-problem.html">The Josephus Problem: Part 1: The Problem</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/approximating-pi-happy-pi-day.html">Approximating Pi (Happy Pi Day)</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/five-letter-words-part-5-the-try-trie-tree.html">Five Letter Words: Part 5: The Try Trie Tree</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/five-letter-words-part-4-revisiting-diff-by-one.html">Five Letter Words: Part 4: Revisiting Diff by One</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/centillion-a-document-search-engine.html">centillion: a document search engine</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>February 2019</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/any-color-you-like-as-long-as-its-00add8.html">Any Color You Like, As Long As It's 00ADD8</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/a-few-of-my-favorite-peps.html">A Few of My Favorite PEPs</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/context-managers-in-python.html">Context Managers in Python</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>January 2019</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/building-snakemake-command-line-wrappers-for-kubernetes-workflows.html">Building Snakemake Command Line Wrappers for Kubernetes Workflows</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/building-snakemake-command-line-wrappers-for-workflows.html">Building Snakemake Command Line Wrappers for Workflows</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/recursive-backtracking-in-go-for-bioinformatics-applications-3-go-implementation-of-backtracking.html">Recursive Backtracking in Go for Bioinformatics Applications: 3. Go Implementation of Backtracking</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>December 2018</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/recursive-backtracking-in-go-for-bioinformatics-applications-2-generating-variations.html">Recursive Backtracking in Go for Bioinformatics Applications: 2. Generating Variations</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/recursive-backtracking-in-go-for-bioinformatics-applications-1-counting-variations.html">Recursive Backtracking in Go for Bioinformatics Applications: 1. Counting Variations</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/basic-data-structures-in-go-maps.html">Basic Data Structures in Go: Maps</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/learning-bioinformatics-with-go-and-rosalind.html">Learning Bioinformatics with Go and Rosalind</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>October 2018</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/first-post-of-the-fall-part-2-flaskadillo.html">First Post of the Fall, Part 2: Flaskadillo</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/first-post-of-the-fall-part-1-data-commons.html">First Post of the Fall, Part 1: Data Commons</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>May 2018</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/current-projects.html">Current Projects</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>March 2018</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/charlesreid1com-stack.html">Charlesreid1.com Stack</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>February 2018</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/d3-calendar-visualizations.html">D3 Calendar Visualizations</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/project-euler-problem-172.html">Project Euler Problem 172</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>January 2018</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-4-sequence-order.html">4x4 Rubik's Cube: Part 4: Sequence Order</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-3-factoring-permutations.html">4x4 Rubik's Cube: Part 3: Factoring Permutations</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-2-permutations.html">4x4 Rubik's Cube: Part 2: Permutations</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-1-representations.html">4x4 Rubik's Cube: Part 1: Representations</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/lets-generate-permutations.html">Let's Generate Permutations!</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>September 2017</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/five-letter-words-part-3-letter-coverage-and-dynamic-programming.html">Five Letter Words: Part 3: Letter Coverage and Dynamic Programming</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/five-letter-words-part-2-more-five-word-algorithms.html">Five Letter Words: Part 2: More Five-Word Algorithms</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/five-letter-words-part-1-getting-familiar-with-the-list.html">Five Letter Words: Part 1: Getting Familiar With The List</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>August 2017</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/eulers-theorem-the-totient-function-and-calculating-totients-by-hand.html">Euler's Theorem, the Totient Function, and Calculating Totients By Hand</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>July 2017</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/mad-combinatoric-castles.html">Mad Combinatoric Castles</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/project-euler-problem-1.html">Project Euler Problem 1</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/shortest-lattice-paths-and-multiset-permutations.html">Shortest Lattice Paths and Multiset Permutations</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/computing-square-roots-part-2-using-continued-fractions.html">Computing Square Roots: Part 2: Using Continued Fractions</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/computing-square-roots-part-1-using-newtons-method.html">Computing Square Roots: Part 1: Using Newton's Method</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>June 2017</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/cse-143-final-project-hilbert-sort-3-the-code.html">CSE 143 Final Project: Hilbert Sort: 3. The Code</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/cse-143-final-project-hilbert-sort-2-the-solution-algorithm.html">CSE 143 Final Project: Hilbert Sort: 2. The Solution Algorithm</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/cse-143-final-project-hilbert-sort-1-the-problem.html">CSE 143 Final Project: Hilbert Sort: 1. The Problem</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/cse-143-final-project-classy.html">CSE 143 Final Project: Classy</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/cse-143-final-project-checkers.html">CSE 143 Final Project: Checkers</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>May 2017</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/teaching-recursion-with-the-n-queens-problem.html">Teaching Recursion with the N Queens Problem</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/undergraduate-research-project-wireless-sensor-networks-for-internet-of-things-applications-part-2-the-technologies.html">Undergraduate Research Project: Wireless Sensor Networks for Internet of Things Applications (Part 2: The Technologies)</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/undergraduate-research-project-wireless-sensor-networks-for-internet-of-things-applications-part-1-the-project.html">Undergraduate Research Project: Wireless Sensor Networks for Internet of Things Applications (Part 1: The Project)</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>April 2017</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/stunnel.html">Stunnel</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/traveling-schoolteacher-problem.html">Traveling Schoolteacher Problem</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/the-z-machine-a-simple-turing-machine.html">The Z-Machine: A Simple Turing Machine</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/awsome-day-seattle-notes-part-2-networking-security-and-miscellany.html">AWSome Day Seattle Notes: Part 2: Networking, Security, and Miscellany</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/awsome-day-seattle-notes-part-1-the-basics.html">AWSome Day Seattle Notes: Part 1: The Basics</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/setting-up-a-self-hosted-github-clone-with-gitea.html">Setting Up a Self-Hosted Github Clone with Gitea</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/better-timing-of-guava-traveling-salesperson-problem-code-timing-scripts.html">Better Timing of Guava Traveling Salesperson Problem Code: Timing Scripts</a>
            </p>

        </div>

        <div class="v20"></div>


        <div class="well">

            <h2>March 2017</h2>

            <p class="archive">
            <a href="https://charlesreid1.github.io/fixing-bottlenecks-in-the-guava-traveling-salesperson-problem-code.html">Fixing Bottlenecks in the Guava Traveling Salesperson Problem Code</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/python-vs-perl-n-queens-problem.html">Python vs. Perl: N Queens Problem</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/solving-the-traveling-salesperson-problem-with-java-and-guava.html">Solving the Traveling Salesperson Problem with Java and Guava</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/perl-vs-java-n-queens-problem.html">Perl vs. Java: N Queens Problem</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/enigma-cipher-implementation-part-4-combinatorics.html">Enigma Cipher Implementation: Part 4: Combinatorics</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/enigma-cipher-implementation-part-3-enigma-in-java-without-objects.html">Enigma Cipher Implementation: Part 3: Enigma in Java Without Objects</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/enigma-cipher-implementation-part-2-pseudocode.html">Enigma Cipher Implementation: Part 2: Pseudocode</a>
            </p>
            <p class="archive">
            <a href="https://charlesreid1.github.io/enigma-cipher-implementation-part-1-how-it-works.html">Enigma Cipher Implementation: Part 1: How It Works</a>
            </p>

        </div>

        <div class="v20"></div>



<div class="v100"></div>
        </div>

    </div>



</div>



<script type="text/javascript" src="https://charlesreid1.github.io/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="https://charlesreid1.github.io/theme/js/bootstrap-3.3.4.js"></script>
<script type="text/javascript" src="https://charlesreid1.github.io/theme/js/d3-3.5.5.js"></script><script type="text/javascript" src="https://charlesreid1.github.io/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="https://charlesreid1.github.io/theme/js/bootstrap-3.3.4.js"></script>

<footer id="contentinfo" class="body">
<p>&nbsp;</p>
<p>&nbsp;</p>
<center>
	<hr />
</center>
<p>&nbsp;</p>
<p style="text-align: center">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-terminal fa-stack-1x fa-inverse"></i>
    </span>
    Made from the command line with vim by 
    <a href="http://charlesreid1.com">charlesreid1</a><br />
    with help from <a href="https://getbootstrap.com/">Bootstrap</a> and <a href="http://getpelican.com">Pelican</a>.
</p>

<br />

<p style="text-align: center">
    <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-creative-commons fa-stack-1x fa-inverse"></i>
    </span>
    </a>
    <br />
    Licensed under the <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 License</a>.
</p>

<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=11611748;
var sc_invisible=1;
var sc_security="9fcba820";
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>

<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="//c.statcounter.com/11611748/0/9fcba820/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</footer><!-- /#contentinfo -->
</body>
</html>