<!DOCTYPE html>
<html lang="en">
<head>
        <title>charlesreid1</title>
        <meta charset="utf-8" />

        <!--
        CSS styles
        -->
        <link href="/theme/css/bootstrap.css"       rel="stylesheet" type="text/css">
        <!--
        <link href="/theme/css/cyborg.css"          rel="stylesheet" type="text/css">
        <link href="/theme/css/cosmo.css"           rel="stylesheet" type="text/css">
        <link href="/theme/css/sandstone.css"       rel="stylesheet" type="text/css">
        -->
        <link href="/theme/css/slate.css"              rel="stylesheet" type="text/css">
        <link href="/theme/css/font-awesome.css"       rel="stylesheet" type="text/css"/>
        <link href="/theme/css/pygment-solarized.css"  rel="stylesheet" type="text/css"/>


        <!--
        my CSS styles
        -->
        <link href="/theme/css/main.css"            rel="stylesheet" type="text/css">
        <link href="/theme/css/dox.css"             rel="stylesheet" type="text/css">


        <!--
        include Angular first
        -->
        <script type="text/javascript" src="/theme/js/angular-1.3.15.js"></script>
        <script type="text/javascript" src="/theme/js/skrollr-0.6.29.js"></script>
        <script type="text/javascript" src="/theme/js/d3-3.5.5.js"></script>

        <!--
        this seems like a bad idea.
        but if I don't put jquery first, I get errors about unrecognized $s.
        -->
        <script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>

</head>
<body id="index">
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span> 
            </button>
            <a href="https://charlesreid1.github.io" class="navbar-brand">charlesreid1.github.io</a>
        </div>
        <div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav">

                    <li>
                        <a href="https://charlesreid1.com/wiki">Wiki</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com:3000/explore">Git.charlesreid1.com</a>
                    </li>
                    <li>
                        <a href="https://github.com/charlesreid1/charlesreid1-awesome/">charlesreid1 Awesome List</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/notes">Notes</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.github.io">Blog</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/contact">Contact Me</a>
                    </li>

                </ul>
            </div>
        </div>
    </div>
</nav>



<div class="container">

<header>
<div class="row">


    <div class="col-md-12">
        <div class="headtext" style="text-align: center;">
            <h1><b>
                4x4 Rubik's Cube: Part 4: Sequence Order
            </b></h1>
        
            <p class="lead">
                Posted 
                <time datetime="2018-01-25T10:00:00-08:00" pubdate>Thursday 01/25/2018</time>
                in 
                <a href="/category/rubiks-cube.html">Rubiks Cube</a>
                </p>
            <p>
            <span style="font-size: 14px">
                <a href="/4x4-rubiks-cube-part-4-sequence-order.html">permalink</a>
            </span>
            </p>
        </div>

    </div>

</div>
</header>


<div class="v50"></div>


<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="entry-content"><p><em>This is Part 4 of a 4-part blog post 
on the mathematics of the 4x4 Rubik's Cube, 
its relation to algorithms, and some 
curious properties of Rubik's Cubes.</em></p>
<p>See Part 1 of this blog post here: <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-1-representations.html">Part 1: Representations</a></p>
<p>See Part 2 of this blog post here: <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-2-permutations.html">Part 2: Permutations</a></p>
<p>See Part 3 of this blog post here: <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-3-factoring-permutations.html">Part 3: Factoring Permutations</a></p>
<p>You are currently reading Part 4 of this blog post: <strong>Part 4: Sequence Order</strong></p>
<h1>Table of Contents</h1>
<ul>
<li>
<p><a href="#rubiks4-intro">Introduction</a></p>
</li>
<li>
<p><a href="#rubiks4-factoring">Factoring Rubik's Cube Permutations</a></p>
<ul>
<li><a href="#rubiks4-factoring-review">Factoring Permutations: A Review</a></li>
<li><a href="#rubiks4-factoring-cube">Factoring Rubik's Cube Permutations</a></li>
<li><a href="#rubiks4-factoring-R">Computing the Order of Sequence R</a></li>
<li><a href="#rubiks4-factoring-URUpRp">Computing the Order of Sequence U R U' R'</a></li>
<li><a href="#rubiks4-factoring-UR">Computing the Order of Sequence U R</a></li>
</ul>
</li>
<li>
<p><a href="#rubiks4-code">Code</a></p>
</li>
<li>
<p><a href="#rubiks4-conclusions">Project Conclusions</a></p>
</li>
<li>
<p><a href="#rubiks4-references">References</a></p>
</li>
<li>
<p><a href="#rubiks4-appendix">Appendix</a></p>
</li>
</ul>
<p><br />
<br />
<br /></p>
<p><a name="rubiks4-intro"></a></p>
<h1>Introduction</h1>
<p><a name="rubiks4-intro-order"></a></p>
<h2>Order of a Sequence</h2>
<p>As a reminder of our overarching goal: starting with a 
4x4 Rubik's Revenge cube, an arbitrary sequence of moves
will scramble the faces of the cube; but if that move sequence 
is repeatedly applied, eventually the cube will return to its
solved state. </p>
<p>The simplest example is rotating a single face: after applying
the rotation move four times to any face of a solved cube,
the cube will return back to the solved state.</p>
<p>This is also true of more complicated move sequences, such as
<code>U R U' R'</code>, which returns the cube back to its original state
after 6 applications, or the move sequence <code>U R</code>, which
must be applied 105 times before the cube returns back to
its original solved state.</p>
<p>Our goal is to predict this number: given a move sequence,
how many times must that move sequence be applied to a solved 
cube to return the cube back to its solved state?</p>
<p>This number is called the <em>order</em> of a sequence.</p>
<p><a name="rubiks4-intro-sofar"></a></p>
<h2>What We Have Covered So Far</h2>
<p>In prior posts, we have covered a number of key topics 
that this post will synthesize.</p>
<p>We started <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-1-representations.html">Part 1</a> by discussing ways of representing 
the Rubik's Revenge cube, and we settled on a 96-tuple
representation indicating which faces had moved to what 
locations.</p>
<p>That led us to <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-2-permutations.html">Part 2</a>, in which we discussed the two-row
notation for the 96-tuple representing the cube, and 
demonstrated the utility of this representation by 
showing how moves and move sequences would lead to 
permutations that could be written as 96-tuples using
the two-row notation.</p>
<p>In <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-3-factoring-permutations.html">Part 3</a>, we covered some key theoretical results following
Donald Knuth's <u>Art of Computer Programming</u> which allowed
us to develop a permutation algebra to describe the effects 
moves have on the cube. We concluded the previous post 
with an algorithm for factoring permutations into their
intercalation products, and hinted that these permutation
factors were central </p>
<p><a name="rubiks4-factoring"></a></p>
<h1>Factoring Rubik's Cube Permutations</h1>
<p><a name="rubiks4-factoring-review"></a></p>
<h2>Factoring Permutations: A Review</h2>
<p>In <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-3-factoring-permutations.html">Part 3</a> of this series of blog posts, we looked at 
an example multiset permutation of characters. Here it is
written using the two-row notation:</p>
<div class="math">$$
\pi = \bigl(\begin{smallmatrix}
    a &amp; a &amp; b &amp; b &amp; b &amp; b &amp; b &amp; c &amp; c &amp; c &amp; d &amp; d &amp; d &amp; d &amp; d \\
    d &amp; b &amp; c &amp; b &amp; c &amp; a &amp; c &amp; d &amp; a &amp; d &amp; d &amp; b &amp; b &amp; b &amp; d
\end{smallmatrix}\bigr)
$$</div>
<p>We covered a technique for factoring this permutation
into independent cycles of faces,</p>
<div class="math">$$
\pi = \alpha \top \beta \top \dots \top \gamma
$$</div>
<p>and shared Python code to perform this operation. The resulting
factored permutation was:</p>
<div class="math">$$
\pi = \bigl( \begin{smallmatrix}
    a &amp; d &amp; d &amp; b &amp; c &amp; d &amp; b &amp; b &amp; c \\
    d &amp; d &amp; b &amp; c &amp; d &amp; b &amp; b &amp; c &amp; a
\end{smallmatrix} \bigr)
\top
\bigl( \begin{smallmatrix}
    a &amp; b \\
    b &amp; a 
\end{smallmatrix} \bigr)
\top 
\bigl( \begin{smallmatrix}
    b &amp; c &amp; d  \\
    c &amp; d &amp; b
\end{smallmatrix} \bigr)
\top 
\bigl( \begin{smallmatrix}
    d \\
    d
\end{smallmatrix} \bigr)
$$</div>
<p><a name="rubiks4-factoring-cube"></a></p>
<h2>Factoring Rubik's Cube Permutations</h2>
<p>To factor a Rubik's Cube permutation, we apply
Algorithm A from the prior post to the two-row
96-tuple representation of the Rubik's Cube 
after it has had the move sequence applied once.</p>
<p>(Note that we only need to apply the sequence
to the cube <em>once</em>, even if the order of that 
sequence is in the tens of thousands.)</p>
<p>Let's look at a few move sequences for 
some examples:</p>
<p><a name="rubiks4-factoring-R"></a></p>
<h2>Computing the Order of Sequence R</h2>
<p>We begin with the solved state, and apply the 
move R to the cube. The result is the 
two-line representation:</p>
<div class="highlight"><pre><span></span>(01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96)
(01 02 03 36 05 06 07 40 09 10 11 44 13 14 15 48 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 84 37 38 39 88 41 42 43 92 45 46 47 96 61 57 53 49 62 58 54 50 63 59 55 51 64 60 56 52 16 66 67 68 12 70 71 72 08 74 75 76 04 78 79 80 81 82 83 77 85 86 87 73 89 90 91 69 93 94 95 65)
</pre></div>


<p>Now, we can carry out the Algorithm A procedure on
this two-row representation. When we do that, we will
find that there are a large number of one-element 
independent factors; these are the faces that do not 
move during the move sequence R. </p>
<p>Here is a list of factors that are found by Algorithm A:</p>
<div class="highlight"><pre><span></span>Factor sizes: {1, 4}
Factors:
[36, 84, 77, 4]
[40, 88, 73, 8]
[44, 92, 69, 12]
[48, 96, 65, 16]
[61, 64, 52, 49]
[57, 63, 56, 50]
[53, 62, 60, 51]
[58, 59, 55, 54]
Independent Faces: [1, 2, 3, 5, 6, 7, 9, 10, 11, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 39, 41, 42, 43, 45, 46, 47, 66, 67, 68, 70, 71, 72, 74, 75, 76, 78, 79, 80, 81, 82, 83, 85, 86, 87, 89, 90, 91, 93, 94, 95]
Least common multiple: 4
</pre></div>


<p>The largest set of faces that are exchanged is 4, and 
the smallest is 1. No other groups of faces being 
exchanged have any other sizes. This means that if 
we apply the sequence 4 times, each of those groups 
of faces being interchanged will have returned to their 
original state.</p>
<p>This tells us what we already knew: that if we apply the 
sequence "R", it rotates groups of pieces in a sequence 
of 4 moves each, so overall the order of this permutation 
is 4 - if we apply the sequence R to a solved 4x4 Rubik's 
Revenge cube 4 times, the cube will return to the solved 
state.</p>
<p>To formalize this, if we have cycles with arbitrary lengths, 
we must apply the sequence a number of times equal to the 
least common multiple of each factor's size. (For example, 
if we had a cycle of length 3 above, the cycle order would 
have been 12 - because the sequence must be applied 12 times 
before the 4-cycle face exchanges "sync up" with the 3-cycle 
face exchanges.)</p>
<p>Let's look at a slightly more complicated move sequence
to illustrate this point.</p>
<p><a name="rubiks4-factoring-URUpRp"></a></p>
<h3>Computing the Order of Sequence U R U' R'</h3>
<p>As before, we begin by applying the move sequence
once to a solved cube to generate the two-row
n-tuple representation:</p>
<div class="highlight"><pre><span></span>(01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96)
(01 02 03 77 05 06 07 73 09 10 11 69 16 12 08 20 17 18 19 36 21 22 23 24 25 26 27 28 29 30 31 32 49 50 51 33 37 38 39 40 41 42 43 44 45 46 47 48 13 56 60 64 53 54 55 34 57 58 59 35 61 62 63 04 96 66 67 68 14 70 71 72 15 74 75 76 65 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 52)
</pre></div>


<p>Next, we factor this permutation using Algorithm A:</p>
<div class="highlight"><pre><span></span>Factor sizes: {1, 3, 6}
Factors:
[77, 65, 96, 52, 64, 4]
[73, 15, 8]
[69, 14, 12]
[16, 20, 36, 33, 49, 13]
[50, 56, 34]
[51, 60, 35]
Independent Faces: [1, 2, 3, 5, 6, 7, 9, 10, 11, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 53, 54, 55, 57, 58, 59, 61, 62, 63, 66, 67, 68, 70, 71, 72, 74, 75, 76, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95]
Least common multiple: 6
</pre></div>


<p>This time, we get a couple of cycles with different lengths.
We have four cycles of length 3, and two cycles of length 6,
plus many cycles of length 1 (the unpermuted faces).</p>
<p>The LCM of 3 and 6 is 6, so the overall order of the 
move sequence <code>U R U' R'</code> is 6.</p>
<p><a name="rubiks4-factoring-UR"></a></p>
<h3>Computing the Order of Sequence U R</h3>
<p>The last sequence we'll look at is the move sequence UR.</p>
<p>This particular permutation represents an 
interesting corner case: in <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-1-representations.html">Part 1</a> of this post,
when we came up with our tuple representation
for the cube, we treated each face as being
non-interchangeable, by giving each face a 
unique number. This means that, for example,
we cannot swap two arbitrary red faces, since
they are attached to other faces via a double edge
or a corner piece.</p>
<p>This assumption does <em>not</em> hold for faces 
in the center of the cube. Because center faces
are not attached to any other faces (mechanically 
speaking), the four distinct integers representing
four colored faces can actually be interchanged.</p>
<p>This plays out with the sequence <code>U R</code> as follows:</p>
<p>We start with the two-line representation of the 
n-tuple:</p>
<div class="highlight"><pre><span></span>(01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96)
(13 09 05 01 14 10 06 02 15 11 07 03 48 44 40 36 33 34 35 84 21 22 23 24 25 26 27 28 29 30 31 32 61 57 53 49 37 38 39 88 41 42 43 92 45 46 47 96 16 66 67 68 62 58 54 50 63 59 55 51 64 60 56 52 17 18 19 20 12 70 71 72 08 74 75 76 04 78 79 80 81 82 83 77 85 86 87 73 89 90 91 69 93 94 95 65)
</pre></div>


<p>We can factor this tuple as follows:</p>
<div class="highlight"><pre><span></span>Factor sizes: {1, 3, 4, 7, 15}
Factors:
[13, 48, 96, 65, 17, 33, 61, 64, 52, 68, 20, 84, 77, 4, 1]
[9, 15, 40, 88, 73, 8, 2]
[5, 14, 44, 92, 69, 12, 3]
[10, 11, 7, 6]
[36, 49, 16]
[34, 57, 63, 56, 50, 66, 18]
[35, 53, 62, 60, 51, 67, 19]
[58, 59, 55, 54]
Independent Faces: [21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 37, 38, 39, 41, 42, 43, 45, 46, 47, 70, 71, 72, 74, 75, 76, 78, 79, 80, 81, 82, 83, 85, 86, 87, 89, 90, 91, 93, 94, 95]
Least common multiple: 420
</pre></div>


<p>However, the adventurous cuber will find, when actually 
carrying out this move sequence, that the order is in fact 
105, and not 420.</p>
<p>The reason the predicted cube order is 4 times larger than
expected is because, after 105 applications of the move 
sequence, the cube has not actually returned to its original
state, but the only remaining faces that are scrambled
are center faces, which are in fact interchangeable.</p>
<p>Note this group of 4 faces that are permuted:</p>
<div class="highlight"><pre><span></span>[10, 11, 7, 6]
</pre></div>


<p>These are the four center squares from the <code>U</code> face. 
If we exclude this group (treating 10, 11, 7, and 6 as 
perfectly interchangeable), the length of all factors
no longer contains 4:</p>
<div class="highlight"><pre><span></span>Factor sizes: {1, 3, 7, 15}
</pre></div>


<p>Including the 4, we had</p>
<p>LCM(1,3,4,7,15) = 420</p>
<p>but excluding the 4, we get:</p>
<p>LCM(1,3,7,15) = 105</p>
<p>Systematically, we can search for any groups that contain
<em>only</em>  faces from the center, and treat 1 such group of 
length n as n groups of length 1 (not contributing to the 
order of the move sequence).</p>
<p>This provides an interesting contrast between the 4x4 Rubik's 
Revenge cube, in which any center faces may be interchanged with 
any other center faces, and the 3x3 Rubik's Cube, in which
the center faces always remain fixed in relation to one another.</p>
<p><a name="rubiks4-factoring-UwRw"></a></p>
<h3>Computing the Order of Sequence Uw Rw</h3>
<p>We mentioned in <a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-1-representations.html">Part 1</a> 
that the move notation <code>Uw</code> or <code>Dw</code> indicates a 
quarter clockwise turn of two layers of a face,
not one. We can write the permutation that results
from the move sequence <code>Uw Rw</code> as:</p>
<div class="highlight"><pre><span></span>(01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96)
(13 09 05 01 14 10 06 02 47 43 39 35 48 44 40 36 33 34 83 84 37 38 87 88 25 26 27 28 29 30 31 32 61 57 53 49 62 58 54 50 41 42 91 92 45 46 95 96 16 15 67 68 12 11 71 72 63 59 55 51 64 60 56 52 17 18 19 20 21 22 23 24 08 07 75 76 04 03 79 80 81 82 78 77 85 86 74 73 89 90 70 69 93 94 66 65)
</pre></div>


<p>Factoring this permutation, we get:</p>
<div class="highlight"><pre><span></span>Factor sizes: {1, 3, 15}
Factors:
[13, 48, 96, 65, 17, 33, 61, 64, 52, 68, 20, 84, 77, 4, 1]
[9, 47, 95, 66, 18, 34, 57, 63, 56, 72, 24, 88, 73, 8, 2]
[5, 14, 44, 92, 69, 21, 37, 62, 60, 51, 67, 19, 83, 78, 3]
[10, 43, 91, 70, 22, 38, 58, 59, 55, 71, 23, 87, 74, 7, 6]
[39, 54, 11]
[35, 53, 12]
[40, 50, 15]
[36, 49, 16]
Independent Faces: [25, 26, 27, 28, 29, 30, 31, 32, 41, 42, 45, 46, 75, 76, 79, 80, 81, 82, 85, 86, 89, 90, 93, 94]
Least common multiple: 15
</pre></div>


<p>Several groups of 3 faces and of 15 faces, respectively, are permuted,
giving an LCM of 15. Thus, the order of move sequence <code>Uw Rw</code> is 15.</p>
<p>We'll look at the factoring of one last sequence: <code>U Rw</code>.</p>
<p><a name="rubiks4-factoring-URw"></a></p>
<h3>Computing the Order of Sequence U Rw</h3>
<p>Here is the permutation representing the 
permutation resulting from the sequence U Rw:</p>
<div class="highlight"><pre><span></span>(01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96)
(13 09 05 01 14 10 06 02 47 43 39 35 48 44 40 36 33 34 83 84 21 22 23 24 25 26 27 28 29 30 31 32 61 57 53 49 37 38 87 88 41 42 91 92 45 46 95 96 16 15 67 68 62 58 54 50 63 59 55 51 64 60 56 52 17 18 19 20 12 11 71 72 08 07 75 76 04 03 79 80 81 82 78 77 85 86 74 73 89 90 70 69 93 94 66 65)
</pre></div>


<p>Factoring this permutation, we get:</p>
<div class="highlight"><pre><span></span>Factor sizes: {1, 3, 4, 10, 15, 16}
Factors:
[13, 48, 96, 65, 17, 33, 61, 64, 52, 68, 20, 84, 77, 4, 1]
[9, 47, 95, 66, 18, 34, 57, 63, 56, 50, 15, 40, 88, 73, 8, 2]
[5, 14, 44, 92, 69, 12, 35, 53, 62, 60, 51, 67, 19, 83, 78, 3]
[10, 43, 91, 70, 11, 39, 87, 74, 7, 6]
[36, 49, 16]
[58, 59, 55, 54]
Independent Faces: [21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 37, 38, 41, 42, 45, 46, 71, 72, 75, 76, 79, 80, 81, 82, 85, 86, 89, 90, 93, 94]
Least common multiple: 240
</pre></div>


<p>The order of the move sequence <code>U Rw</code> is 240.</p>
<p><a name="rubiks4-code"></a></p>
<h1>Code</h1>
<p>The code that forms the permutation tuple for a given move sequence
and performs the factoring of that tuple is in <a href="https://charlesreid1.com:3000/charlesreid1/rubiks-cube-cycles/src/master/sequence_order.py">sequence_order.py</a>.</p>
<p>The <code>sequence_order.py</code> file utilizes the 
<a href="https://github.com/dwalton76/rubiks-cube-NxNxN-solver">dwalton76/rubiks-cube-NxNxN-solver</a>
library from Github to apply the move sequence once to a cube
to determine the resulting permutation tuple. It then factors 
this tuple into products and finds the LCM of their lengths.</p>
<p>The code in <code>sequence_order.py</code> is grouped into functions,
with the key funtion being <code>factor_permutation(top, bottom)</code>, which 
takes the top and bottom rows of the two-row representation
of a move sequence's permutation.</p>
<p>The method then performs the factoring procedure covered in
<a href="https://charlesreid1.github.io/4x4-rubiks-cube-part-3-factoring-permutations.html">Part 3</a>.</p>
<p>Here is the body of the method:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">factor_permutation</span><span class="p">(</span><span class="n">perm_top</span><span class="p">,</span><span class="n">perm_bot</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Factor a permutation into its lowest terms</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="mi">96</span>

    <span class="c1"># Need a way to also mark them as used... bit vector</span>
    <span class="n">used_vector</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">perm_top</span><span class="p">)</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">perm_top</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">used_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">factors</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># If we still have values to pick out:</span>
    <span class="k">while</span><span class="p">(</span><span class="mi">0</span> <span class="ow">in</span> <span class="n">used_vector</span><span class="p">):</span>

        <span class="n">factor</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">while</span><span class="p">(</span><span class="bp">True</span><span class="p">):</span>
            <span class="n">used_vector</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">leader</span> <span class="o">=</span> <span class="n">perm_top</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">follower</span> <span class="o">=</span> <span class="n">perm_bot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="n">i</span> <span class="o">=</span> <span class="n">perm_top</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">follower</span><span class="p">)</span>
            <span class="k">while</span><span class="p">(</span><span class="n">used_vector</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">MAX</span><span class="p">):</span>
                    <span class="k">break</span>

            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">MAX</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">follower</span><span class="o">==</span><span class="n">start</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">factor</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">follower</span><span class="p">)</span>

        <span class="c1"># add start to end</span>
        <span class="n">factor</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>

        <span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1">#import pdb; pdb.set_trace()</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">used_vector</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">perm_top</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">factors</span>
</pre></div>


<p>This was called by the method applying move sequences
to the Rubik's Cube to obtain the two-row permutation
corresponding to the move sequence of interest.</p>
<p><a name="rubiks4-conclusions"></a></p>
<h1>Project Conclusions</h1>
<p>In addition to being interesting, this project led to 
some deep insights into the workings of the Rubik's Cube
and ways to think about move sequences.</p>
<p>More than that, the Rubik's Cube is a toy that provides 
real insight into combinatorics and group theory. The 
concept of order, and the process of thinking through 
different representations of the cube and their consequences
for the implemetation of the final algorithm, provide 
good practice for problems in other, related domains.</p>
<p>This project began with a simple question. 
While playing with the Rubik's Cube,
we discovered this property of cycles 
(it is actually difficult to miss,
even when learning the beginner method,
as many of the move sequences involved in the 
beginner method have small orders, so it is 
easy to see them repeat.)
The question we set out to answer was,
given an arbitrary sequence, can we determine
the order of that sequence? </p>
<p>The key to answering this question ultimately
lies in the representation of the permutations;
the right representation makes finding the 
order possible. but it took some trial 
and error with different representations 
before discovering the right approach.</p>
<p>To anyone who has played with the Rubik's Cube
before, it seems natural that there would be 
<em>some</em> way to represent moves applied to the cube
in some kind of algebraic terms.
The intercalation product was the key concept
for developing a permutation algebra.
Knuth's Algorithm A was the key concept 
for factoring permutations into their 
respective independent cycles.</p>
<p>Once an algorithm to factor permutations was developed,
the rest was a straightforward calculation of the LCM
of the lengths of each factor.</p>
<p>The project was computationally challenging;
recursion was required to implement Algorithm A,
the Rubik's Cube solver had to be modified,
and there were many bugs along the way.</p>
<p>The procedure we used here can be applied to other problems.
Our procedure was:</p>
<ul>
<li>Find a proper, convenient representation for the system state</li>
<li>Break down the variations of the system into simple cases or steps</li>
<li>Move away from the specific system, 
    and keep the approach mathematially general. <strong>This is by far the the most 
    important step!</strong></li>
<li>Study the literature and solutions to problems, to become familiar
    with different ways of representing a problem. Different problems
    lend themselves well to different representations, so the more familiar
    you are with different representations, the more problems you'll be able
    to tackle.</li>
<li>The only way to get familiar with different problem-solving approaches 
    is through practice. It helps to start with easier problems, both because
    you can score some quick points and feel more confident, and also because
    combinatorics and group theory problems often tend to appear simple,
    but deceptively so. The devil is in the details.</li>
</ul>
<p><a name="rubiks4-references"></a></p>
<h1>References</h1>
<ol>
<li>
<p>"Rubik's Cube". Charlesreid1.com wiki, Charles Reid. Edited 25 January 2017. Accessed 25 January 2017.
&lt;<a href="https://charlesreid1.com/wiki/Rubiks_Cube">https://charlesreid1.com/wiki/Rubiks_Cube</a>&gt;</p>
</li>
<li>
<p>"Rubik's Revenge". Charlesreid1.com wiki, Charles Reid. Edited 25 January 2017. Accessed 25 January 2017.
&lt;<a href="https://charlesreid1.com/wiki/Rubiks_Revenge">https://charlesreid1.com/wiki/Rubiks_Revenge</a>&gt;</p>
</li>
<li>
<p>"Rubik's Cube/Tuple". Charlesreid1.com wiki, Charles Reid. Edited 25 January 2017. Accessed 25 January 2017.
&lt;<a href="https://charlesreid1.com/wiki/Rubiks_Cube/Tuple">https://charlesreid1.com/wiki/Rubiks_Cube/Tuple</a>&gt;</p>
</li>
<li>
<p>"Rubik's Cube/Permutations". Charlesreid1.com wiki, Charles Reid. Edited 25 January 2017. Accessed 25 January 2017.
&lt;<a href="https://charlesreid1.com/wiki/Rubiks_Cube/Permutations">https://charlesreid1.com/wiki/Rubiks_Cube/Permutations</a>&gt;</p>
</li>
<li>
<p>"Github - dwalton76/rubiks-cube-NxNxN-solver". dwalton76, Github Repository, Github Inc. Accessed 11 January 2017.
&lt;<a href="https://github.com/dwalton76/rubiks-cube-NxNxN-solver">https://github.com/dwalton76/rubiks-cube-NxNxN-solver</a>&gt;</p>
</li>
<li>
<p>"Rubik's Cube NxNxN Solver". Git repository, git.charlesreid1.com. Charles Reid. Updated 25 January 2017.
&lt;<a href="https://charlesreid1.com:3000/charlesreid1/rubiks-cube-nnn-solver">https://charlesreid1.com:3000/charlesreid1/rubiks-cube-nnn-solver</a>&gt;</p>
</li>
<li>
<p>"Rubiks Cube Cycles". Git repository, git.charlesreid1.com. Charles Reid. Updated 25 January 2017.
&lt;<a href="https://charlesreid1.com:3000/charlesreid1/rubiks-cube-cycles">https://charlesreid1.com:3000/charlesreid1/rubiks-cube-cycles</a>&gt;</p>
</li>
</ol>
<p><a name="rubiks4-appendix"></a></p>
<h1>Appendix</h1>
<p>That concludes our discussion of computing the order of move sequences
on a Rubik's Cube. There are many move sequences, and many orders, 
ranging from 1 or 2 up to nearly 100,000. We plan to assemble a 
web site to help readers explore some move sequences and their 
orders - so check back soon...</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script></div>

    </div>
</div>

<div class="v20"></div>

<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="tags">
            <p>Tags:&nbsp;&nbsp;&nbsp;
                    <a href="/tag/rubiks-cube.html">rubiks cube</a>
                    &nbsp;&nbsp;
                    <a href="/tag/combinatorics.html">combinatorics</a>
                    &nbsp;&nbsp;
                    <a href="/tag/permutations.html">permutations</a>
                    &nbsp;&nbsp;
                    <a href="/tag/python.html">python</a>
                    &nbsp;&nbsp;
                    <a href="/tag/puzzles.html">puzzles</a>
                    &nbsp;&nbsp;
                    <a href="/tag/art-of-computer-programming.html">art of computer programming</a>
                    &nbsp;&nbsp;
                    <a href="/tag/knuth.html">knuth</a>
                    &nbsp;&nbsp;
        </div>

    </div>
</div>


<div class="v200"></div>

</div>


<script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="/theme/js/bootstrap-3.3.4.js"></script>
<script type="text/javascript" src="/theme/js/d3-3.5.5.js"></script>
<!--
<script type="text/javascript" src="/theme/js/leaflet-0.7.3.js"></script>
<script type="text/javascript" src="/theme/js/leaflet.ajax.min.js"></script>
--><script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="/theme/js/bootstrap-3.3.4.js"></script>

<footer id="contentinfo" class="body">
<p>&nbsp;</p>
<p>&nbsp;</p>
<center>
	<hr />
</center>
<p>&nbsp;</p>
<p style="text-align: center">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-terminal fa-stack-1x fa-inverse"></i>
    </span>
    Made from the command line with vim by 
    <a href="http://charlesreid1.com">charlesreid1</a><br />
    with help from <a href="https://getbootstrap.com/">Bootstrap</a> and <a href="http://getpelican.com">Pelican</a>.
</p>

<br />

<p style="text-align: center">
    <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-creative-commons fa-stack-1x fa-inverse"></i>
    </span>
    </a>
    <br />
    Licensed under the <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 License</a>.
</p>

<!-- StatCounter -->
<script type="text/javascript">
var sc_project=11611748;
var sc_invisible=1;
var sc_security="9fcba820";
var scJsHost = (("https:" == document.location.protocol) ?
        "https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
        scJsHost+
        "statcounter.com/counter/counter.js'></"+"script>");
</script>

<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="//c.statcounter.com/11611748/0/9fcba820/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->

</footer><!-- /#contentinfo -->
</body>
</html>