<!DOCTYPE html>
<html lang="en">
<head>
        <title>charlesreid1</title>
        <meta charset="utf-8" />

        <!--
        CSS styles
        -->
        <link href="/theme/css/bootstrap.css"       rel="stylesheet" type="text/css">
        <link href="/theme/css/slate.css"              rel="stylesheet" type="text/css">
        <link href="/theme/css/font-awesome.css"       rel="stylesheet" type="text/css"/>
        <link href="/theme/css/pygment-solarized.css"  rel="stylesheet" type="text/css"/>

        <!--
        my CSS styles
        -->
        <link href="/theme/css/main.css"            rel="stylesheet" type="text/css">
        <link href="/theme/css/dox.css"             rel="stylesheet" type="text/css">


        <!--
        include Angular first
        -->
        <script type="text/javascript" src="/theme/js/angular-1.3.15.js"></script>
        <script type="text/javascript" src="/theme/js/skrollr-0.6.29.js"></script>
        <script type="text/javascript" src="/theme/js/d3-3.5.5.js"></script>

        <!--
        this seems like a bad idea.
        but if I don't put jquery first, I get errors about unrecognized $s.
        -->
        <script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>

</head>
<body id="index">
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span> 
            </button>
            <a href="https://charlesreid1.github.io" class="navbar-brand">charlesreid1.github.io</a>
        </div>
        <div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav">

                    <li>
                        <a href="https://charlesreid1.com/wiki">Wiki</a>
                    </li>
                    <li>
                        <a href="https://git.charlesreid1.com/explore">Git</a>
                    </li>
                    <li>
                        <a href="http://spotify.charlesreid1.com">Music</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/life">Life</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.github.io">Blog</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/about">About Me</a>
                    </li>

                </ul>
            </div>
        </div>
    </div>
</nav>



<div class="container">

<header>
<div class="row">


    <div class="col-md-12">
        <div class="headtext" style="text-align: center;">
            <h1><b>
                Basic Data Structures in Go
            </b></h1>
        
            <p class="lead">
                Posted 
                <time datetime="2018-12-19T20:00:00-08:00" pubdate>Wednesday 12/19/2018</time>
                in 
                <a href="/category/rosalind.html">Rosalind</a>
                </p>
            <p>
            <span style="font-size: 14px">
                <a href="/drafts/basic-data-structures-in-go.html">permalink</a>
            </span>
            </p>
        </div>

    </div>

</div>
</header>


<div class="v50"></div>


<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="entry-content"><h2>Basic Data Structures in Go</h2>
<p>Continuing with our series of blog posts on what
we've been learning about Go in the process of solving
problems on Rosalind.info, this post will cover how 
some basic data structures work in Go, and how we
used each to solve problems from the Chapter 1 Rosalind
problems.</p>
<h3>Maps</h3>
<p>The simplest way to describe a map is to say it is a
structure useful for storing key-value pairs.</p>
<p>Before we walk through what maps look like in Go, let's
talk about what a map is (in the data structure sense).
And to do that, it's useful to talk a bit about mathematical
functions and maps in the mathematical sense.</p>
<h4>What is a map</h4>
<p>The term "map" is taken from mathematics. A map is just a
relationship - a general term, but still useful. Most 
mathematics courses deal with functions, which are formally 
defined as <strong>maps</strong> from one set of numbers onto another,
such that one input corresponds to one output.</p>
<p>A (data structure) map, similarly, is a relationship between
two sets - a key set, and a value set. Each key corresponds
to only one value. </p>
<p>Maps are typically stored under the hood as either a hash
map (which does not sort keys and has very fast O(1), or
constant time, operations) or a tree map (which sorts keys 
using a binary tree and has slower O(log N) operations).</p>
<h4>Map notation in Go</h4>
<p>In Go, map types are denoted <code>map[keyType]valueType</code>.</p>
<p>For example, to map strings to integers, we would use
a map of type <code>map[string]int</code>. </p>
<p>We create a map variable by declaring its type:</p>
<div class="highlight"><pre><span></span>var m map[string]int
</pre></div>


<p>However, this does not allocate any space for the map,
and trying to add keys to the map at this point would
result in an error.</p>
<p>We need to actually allocate space for the map. In Go,
you can allocate space for a map two ways: first, using
Go's built-in <code>make()</code> function; and second, by creating
and populating the map in one line.</p>
<h4>Using <code>make()</code> with maps</h4>
<p>To allocate space for a map, you can use the <code>make()</code>
function and pass it the map type. This will actually
create space in memory for the map, and allow you to 
add items or look up keys in the map.</p>
<div class="highlight"><pre><span></span>var m map[string]int
m = make(map[string]int)
</pre></div>


<h4>Creating and populating</h4>
<p>If you want to create and populate the map in one line,
you can specify the type, then have trailing brackets
containing the items you want to add:</p>
<div class="highlight"><pre><span></span>// Create an empty map
m := map[string]int{}
</pre></div>


<div class="highlight"><pre><span></span>// Create and populate a map
m := map[string]int{&quot;A&quot;:10, &quot;T&quot;:15, &quot;G&quot;:20, &quot;C&quot;:25}
</pre></div>


<h4>Zero values</h4>
<p>One feature of maps that makes them really easy to work
with is, if you try and look up a key, and the key does
not exist in the map, the map will not raise an exception
(which Python does), it will return the zero value of 
the value type. </p>
<p>For example, the zero value of the <code>int</code> type is 0, 
so if we create a map like <code>m := map[string]int{"A":10}</code>
and we then look up a key that isn't in the map, like 
<code>m["G"]</code>, Go will return 0.</p>
<p>Similarly, the zero value for booleans is false, so you
can utilize the zero value behavior to create a set data
structure using maps. By creating a <code>map[keyType]bool</code>
map, you can use the boolean value to indicate membership
of a key in the given set. Then, if you look up keys that
do not exist in the map, Go will return the zero value of
booleans by default, which will be false.</p>
<h4>Example: Assembling kmer histogram</h4>
<p>Here is an example using maps: this function assembles
a kmer histogram from a strand of DNA base pairs. To do
this, it loops over every codon in the DNA strand and
increments a counter in a map. Finally, this histogram
map is returned. (This function is useful for determining
the most frequent kmer.)</p>
<div class="highlight"><pre><span></span><span class="c1">// Return the histogram of kmers of length k </span>
<span class="c1">// found in the given input</span>
<span class="kd">func</span> <span class="nx">KmerHistogram</span><span class="p">(</span><span class="nx">input</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">k</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="p">,</span><span class="kt">error</span><span class="p">)</span> <span class="p">{</span>

    <span class="nx">result</span> <span class="o">:=</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="p">{}</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">input</span><span class="p">)&lt;</span><span class="mi">1</span> <span class="p">{</span>
        <span class="nx">err</span> <span class="o">:=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;Error: input string was not DNA. Only characters ATCG are allowed, you had %s&quot;</span><span class="p">,</span><span class="nx">input</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">errors</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Number of substring overlaps</span>
    <span class="nx">overlap</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="o">-</span> <span class="nx">k</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1">// If overlap &lt; 1, we are looking</span>
    <span class="c1">// for kmers longer than our input</span>
    <span class="k">if</span> <span class="nx">overlap</span><span class="p">&lt;</span><span class="mi">1</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">,</span><span class="kc">nil</span>
    <span class="p">}</span>

    <span class="c1">// Iterate over each position,</span>
    <span class="c1">// extract the string,</span>
    <span class="c1">// increment the count.</span>
    <span class="k">for</span> <span class="nx">i</span><span class="o">:=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="p">&lt;</span><span class="nx">overlap</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="c1">// Get the kmer of interest</span>
        <span class="nx">substr</span> <span class="o">:=</span> <span class="nx">input</span><span class="p">[</span><span class="nx">i</span><span class="p">:</span><span class="nx">i</span><span class="o">+</span><span class="nx">k</span><span class="p">]</span>

        <span class="c1">// If it doesn&#39;t exist, the value is 0</span>
        <span class="nx">result</span><span class="p">[</span><span class="nx">substr</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">result</span><span class="p">,</span><span class="kc">nil</span>
<span class="p">}</span>
</pre></div>


<h3>Strings</h3>
<h3>Bit Vectors</h3></div>

    </div>
</div>

<div class="v20"></div>

<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="tags">
            <p>Tags:&nbsp;&nbsp;&nbsp;
                    <a href="/tag/go.html">go</a>
                    &nbsp;&nbsp;
                    <a href="/tag/golang.html">golang</a>
                    &nbsp;&nbsp;
                    <a href="/tag/rosalind.html">rosalind</a>
                    &nbsp;&nbsp;
                    <a href="/tag/bioinformatics.html">bioinformatics</a>
                    &nbsp;&nbsp;
        </div>

    </div>
</div>


<div class="v200"></div>

</div>


<script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="/theme/js/bootstrap-3.3.4.js"></script>
<script type="text/javascript" src="/theme/js/d3-3.5.5.js"></script>
<!--
<script type="text/javascript" src="/theme/js/leaflet-0.7.3.js"></script>
<script type="text/javascript" src="/theme/js/leaflet.ajax.min.js"></script>
--><script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="/theme/js/bootstrap-3.3.4.js"></script>

<footer id="contentinfo" class="body">
<p>&nbsp;</p>
<p>&nbsp;</p>
<center>
	<hr />
</center>
<p>&nbsp;</p>
<p style="text-align: center">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-terminal fa-stack-1x fa-inverse"></i>
    </span>
    Made from the command line with vim by 
    <a href="http://charlesreid1.com">charlesreid1</a><br />
    with help from <a href="https://getbootstrap.com/">Bootstrap</a> and <a href="http://getpelican.com">Pelican</a>.
</p>

<br />

<p style="text-align: center">
    <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-creative-commons fa-stack-1x fa-inverse"></i>
    </span>
    </a>
    <br />
    Licensed under the <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 License</a>.
</p>

<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=11611748;
var sc_invisible=1;
var sc_security="9fcba820";
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>

<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="//c.statcounter.com/11611748/0/9fcba820/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</footer><!-- /#contentinfo -->
</body>
</html>