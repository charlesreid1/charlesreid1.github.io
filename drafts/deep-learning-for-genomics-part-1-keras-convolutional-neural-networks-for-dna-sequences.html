<!DOCTYPE html>
<html lang="en">
<head>
        <title>charlesreid1</title>
        <meta charset="utf-8" />

        <!--
        CSS styles
        -->
        <link href="https://charlesreid1.github.io/theme/css/bootstrap.css"       rel="stylesheet" type="text/css">
        <link href="https://charlesreid1.github.io/theme/css/slate.css"              rel="stylesheet" type="text/css">
        <link href="https://charlesreid1.github.io/theme/css/font-awesome.css"       rel="stylesheet" type="text/css"/>
        <link href="https://charlesreid1.github.io/theme/css/pygment-solarized.css"  rel="stylesheet" type="text/css"/>

        <!--
        my CSS styles
        -->
        <link href="https://charlesreid1.github.io/theme/css/main.css"            rel="stylesheet" type="text/css">
        <link href="https://charlesreid1.github.io/theme/css/dox.css"             rel="stylesheet" type="text/css">


        <!--
        include Angular first
        -->
        <script type="text/javascript" src="https://charlesreid1.github.io/theme/js/angular-1.3.15.js"></script>
        <script type="text/javascript" src="https://charlesreid1.github.io/theme/js/skrollr-0.6.29.js"></script>
        <script type="text/javascript" src="https://charlesreid1.github.io/theme/js/d3-3.5.5.js"></script>

        <!--
        this seems like a bad idea.
        but if I don't put jquery first, I get errors about unrecognized $s.
        -->
        <script type="text/javascript" src="https://charlesreid1.github.io/theme/js/jquery-1.11.2.js"></script>

</head>
<body id="index">
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span> 
            </button>
            <a href="https://charlesreid1.github.io" class="navbar-brand">charlesreid1.github.io</a>
        </div>
        <div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav">

                    <li>
                        <a href="https://charlesreid1.com/wiki">Wiki</a>
                    </li>
                    <li>
                        <a href="https://git.charlesreid1.com/explore">Git</a>
                    </li>
                    <li>
                        <a href="http://spotify.charlesreid1.com">Music</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/life">Life</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.github.io">Blog</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/about">About Me</a>
                    </li>

                </ul>
            </div>
        </div>
    </div>
</nav>



<div class="container">

<header>
<div class="row">


    <div class="col-md-12">
        <div class="headtext" style="text-align: center;">
            <h1><b>
                Deep Learning for Genomics: Part 1: Keras Convolutional Neural Networks for DNA Sequences
            </b></h1>
        
            <p class="lead">
                Posted 
                <time datetime="2019-05-08T14:00:00-07:00" pubdate>Wednesday 05/08/2019</time>
                in 
                <a href="https://charlesreid1.github.io/category/computational-biology.html">Computational Biology</a>
                </p>
            <p>
            <span style="font-size: 14px">
                <a href="https://charlesreid1.github.io/drafts/deep-learning-for-genomics-part-1-keras-convolutional-neural-networks-for-dna-sequences.html">permalink</a>
            </span>
            </p>
        </div>

    </div>

</div>
</header>


<div class="v50"></div>


<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="entry-content"><h1 id="table-of-contents">Table of Contents</h1>
<ul>
<li>
<p>Context: deep learning for biological sciences</p>
</li>
<li>
<p>Problem statement: predicting DNA binding sequences</p>
<ul>
<li>The data</li>
<li>Sequence data</li>
<li>Chromatin data</li>
</ul>
</li>
<li>
<p>Building the neural network</p>
<ul>
<li>Convolutional neural network (1d for sequence)</li>
<li>1D Convolutional neural network architecture</li>
</ul>
</li>
<li>
<p>1D CNN: Sequence Data Only</p>
<ul>
<li>Creating the network architecture</li>
<li>Preparing the data</li>
<li>Training the model</li>
<li>Assessing the model</li>
</ul>
</li>
<li>
<p>1D CNN: Sequence and Chromatin Data</p>
<ul>
<li>Creating the network architecture</li>
<li>Preparing the data</li>
<li>Training the model</li>
<li>Assessing the model</li>
</ul>
</li>
</ul>
<h1 id="context-deep-learning-for-the-life-sciences-the-oreilly-book">Context: Deep Learning for the Life Sciences (the O'Reilly Book)</h1>
<p>Lately we have been involved with a deep learning reading group
that is just getting started at the <a href="https://ivory.idyll.org/lab/">Lab for Data-Intensive Biology</a>,
captained by Professor Titus Brown (both the lab and the reading group).</p>
<p>To get us started, we've been following along with a
recently-published O'Reilly book, <a href="https://www.oreilly.com/library/view/deep-learning-for/9781492039822/"><u>Deep Learning for the
Life Sciences</u></a>.
The entire book focuses on the use of deep learning
and neural networks for various problems in the biological
sciences, but we are particularly interested in Chapter 6,
"Deep Learning for Genomics".</p>
<p>In particular, we're interested in the content of Chapter 6,
which is on utilizing neural networks for genomic sequences.</p>
<p>In this post we'll walk through the basics of setting up
a 1D convolutional neural network in <a href="https://keras.io">Keras</a>
(a neural networks library in Python) to learn from
sequential 1D data (like a DNA sequence).</p>
<h1 id="the-problem-dna-binding-sequences">The Problem: DNA Binding Sequences</h1>
<p>We motivate the problem of setting up a neural network and making
predictions using sequential data using a problem presented
in Chapter 6: the problem of predicting when a DNA sequence
will be a binding site for a transcription factor.</p>
<p>A sequence of DNA is a string of characters drawn from a
four-letter alphabet, GTAC, corresponding to guanine, thymine,
adenine, and cytosine. This chain of DNA is a way of storing
information in a chain of macromolecules.</p>
<p>To turn this biological information into biological function, 
the DNA must first be converted into RNA, and the RNA is
then converted into proteins, ribozymes, and other functional
macromolecules.</p>
<p>The conversion of DNA to RNA is the process of <a href="https://en.wikipedia.org/wiki/Transcription_(biology)">transcription</a>
and begins with the molecule responsible for RNA creation,
called RNA polymerase, binding to the DNA at a particular
location, called a "promoter".  </p>
<p>For obvious reasons, it is useful to be able to predict
where DNA transcription into RNA begins. But it is difficult
to predict, as there are many rules and special cases.</p>
<p>This is the type of problem that deep learning is well-suited
for: a problem that is too complicated for a human to fully
enumerate with rules, and for which there are mountains of
data to train a machine learning algorithm.</p>
<h2 id="the-data">The Data</h2>
<p>Data for this problem are contained in the <a href="https://github.com/deepchem/DeepLearningLifeSciences">deepchem/DeepLearningLifeSciences</a>
repository on Github in the Chapter06 folder.</p>
<p>The data are stored in four files - one for each of the variables
<span class="math">\(X\)</span> (input matrix), <span class="math">\(y\)</span> (output values), <span class="math">\(w\)</span> (weights), and
ids (labels).</p>
<p>The data are stored in the <a href="https://github.com/joblib/joblib">joblib</a>
format, so you will need the joblib Python module
installed to load it (we cover this in the 
prerequisites section below).</p>
<p>The joblib files are similar to Python pickles; they store the
data in an encoded format that makes it possible to quickly
dump and load the data as numpy arrays.</p>
<h3 id="sequence-data">Sequence Data</h3>
<h3 id="chromatin-data">Chromatin Data</h3>
<h2 id="required-packages">Required Packages</h2>
<p>First, we should state that despite the fact that the book
<u>Deep Learning for the Life Sciences</u> is written using
the <a href="https://github.com/deepchem/deepchem">deepchem</a>
deep learning library, we had a number of difficulties
installing deepchem and ended up converting the neural
networks from deepchem to Keras. Thus, deepchem is not 
required to follow along with this blog post.</p>
<p>What is required:</p>
<ul>
<li><a href="https://github.com/joblib/joblib">joblib</a></li>
<li><a href="https://www.numpy.org/">numpy</a></li>
<li><a href="https://scikit-learn.org/">sklearn</a></li>
<li><a href="https://keras.io">keras</a></li>
<li><a href="https://matplotlib.org/">matplotlib</a> and <a href="https://seaborn.pydata.org/">seaborn</a></li>
</ul>
<h1 id="building-the-neural-network">Building the Neural Network</h1>
<p>keras
sequential model
add layers</p>
<h2 id="convolutional-neural-networks">Convolutional Neural Networks</h2>
<p>cnn layers/pattern
2d example
1d example</p>
<h2 id="1d-convolutional-neural-networks-for-sequences">1D Convolutional Neural Networks for Sequences</h2>
<p><br />
<br /></p>
<h1 id="1d-cnn-sequence-data-only">1D CNN: Sequence Data Only</h1>
<h2 id="creating-the-network-architecture">Creating the Network Architecture</h2>
<h2 id="preparing-the-data">Preparing the Data</h2>
<h2 id="training-the-model">Training the Model</h2>
<h2 id="assessing-the-model">Assessing the Model</h2>
<p><br />
<br /></p>
<h1 id="1d-cnn-sequence-and-chromatin-data">1D CNN: Sequence and Chromatin Data</h1>
<h2 id="creating-the-network-architecture_1">Creating the Network Architecture</h2>
<h2 id="preparing-the-data_1">Preparing the Data</h2>
<h2 id="training-the-model_1">Training the Model</h2>
<h2 id="assessing-the-model_1">Assessing the Model</h2>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script></div>

    </div>
</div>

<div class="v20"></div>

<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="tags">
            <p>Tags:&nbsp;&nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/python.html">python</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/keras.html">keras</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/computational-biology.html">computational biology</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/bioinformatics.html">bioinformatics</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/algorithms.html">algorithms</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/dna.html">dna</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/machine-learning.html">machine learning</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/deep-learning.html">deep learning</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/neural-networks.html">neural networks</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/convolutional-neural-networks.html">convolutional neural networks</a>
                    &nbsp;&nbsp;
                    <a href="https://charlesreid1.github.io/tag/cnn.html">cnn</a>
                    &nbsp;&nbsp;
        </div>

    </div>
</div>


<div class="v200"></div>

</div>


<script type="text/javascript" src="https://charlesreid1.github.io/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="https://charlesreid1.github.io/theme/js/bootstrap-3.3.4.js"></script>
<script type="text/javascript" src="https://charlesreid1.github.io/theme/js/d3-3.5.5.js"></script><script type="text/javascript" src="https://charlesreid1.github.io/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="https://charlesreid1.github.io/theme/js/bootstrap-3.3.4.js"></script>

<footer id="contentinfo" class="body">
<p>&nbsp;</p>
<p>&nbsp;</p>
<center>
	<hr />
</center>
<p>&nbsp;</p>
<p style="text-align: center">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-terminal fa-stack-1x fa-inverse"></i>
    </span>
    Made from the command line with vim by 
    <a href="http://charlesreid1.com">charlesreid1</a><br />
    with help from <a href="https://getbootstrap.com/">Bootstrap</a> and <a href="http://getpelican.com">Pelican</a>.
</p>

<br />

<p style="text-align: center">
    <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-creative-commons fa-stack-1x fa-inverse"></i>
    </span>
    </a>
    <br />
    Licensed under the <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 License</a>.
</p>

<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=11611748;
var sc_invisible=1;
var sc_security="9fcba820";
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>

<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="//c.statcounter.com/11611748/0/9fcba820/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</footer><!-- /#contentinfo -->
</body>
</html>