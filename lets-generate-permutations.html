<!DOCTYPE html>
<html lang="en">
<head>
        <title>charlesreid1</title>
        <meta charset="utf-8" />

        <!--
        CSS styles
        -->
        <link href="/theme/css/bootstrap.css"       rel="stylesheet" type="text/css">
        <link href="/theme/css/slate.css"              rel="stylesheet" type="text/css">
        <link href="/theme/css/font-awesome.css"       rel="stylesheet" type="text/css"/>
        <link href="/theme/css/pygment-solarized.css"  rel="stylesheet" type="text/css"/>

        <!--
        my CSS styles
        -->
        <link href="/theme/css/main.css"            rel="stylesheet" type="text/css">
        <link href="/theme/css/dox.css"             rel="stylesheet" type="text/css">


        <!--
        include Angular first
        -->
        <script type="text/javascript" src="/theme/js/angular-1.3.15.js"></script>
        <script type="text/javascript" src="/theme/js/skrollr-0.6.29.js"></script>
        <script type="text/javascript" src="/theme/js/d3-3.5.5.js"></script>

        <!--
        this seems like a bad idea.
        but if I don't put jquery first, I get errors about unrecognized $s.
        -->
        <script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>

</head>
<body id="index">
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span> 
            </button>
            <a href="https://charlesreid1.github.io" class="navbar-brand">charlesreid1.github.io</a>
        </div>
        <div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav">

                    <li>
                        <a href="https://charlesreid1.com/wiki">Wiki</a>
                    </li>
                    <li>
                        <a href="https://git.charlesreid1.com/explore">git.charlesreid1.com</a>
                    </li>
                    <li>
                        <a href="https://github.com/charlesreid1/charlesreid1-awesome/">charlesreid1 Awesome List</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/life">Life</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.github.io">Blog</a>
                    </li>
                    <li>
                        <a href="/contact">Contact Me</a>
                    </li>

                </ul>
            </div>
        </div>
    </div>
</nav>



<div class="container">

<header>
<div class="row">


    <div class="col-md-12">
        <div class="headtext" style="text-align: center;">
            <h1><b>
                Let's Generate Permutations!
            </b></h1>
        
            <p class="lead">
                Posted 
                <time datetime="2018-01-02T18:00:00-08:00" pubdate>Tuesday 01/02/2018</time>
                in 
                <a href="/category/computer-science.html">Computer Science</a>
                </p>
            <p>
            <span style="font-size: 14px">
                <a href="/lets-generate-permutations.html">permalink</a>
            </span>
            </p>
        </div>

    </div>

</div>
</header>


<div class="v50"></div>


<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="entry-content"><h1>Generating Permutations</h1>
<p>In today's post we're going to discuss the generation of permutations.</p>
<p>Often, in combinatorics problems, we are interested in <em>how many</em> different
instances or configurations of a particular thing we can have (what we'll call
"enumeration" or "counting"). However, that is different from wanting to 
actually see all of those configurations. Indeed, if we are counting 
something with an astronomical number of configurations, we don't want 
to try to list all of them.</p>
<p>However, as usual, Donald Knuth, who covers the topic of permutation 
generation in Volume 4A of his classic work, 
<u>The Art of Computer Programming</u>,
uncovers a problem that is much more complicated and subtle
than it initially appears.</p>
<h2>Background: Radix Method for Generating Permutations</h2>
<p>In Volume 4A of his classic work, <u>The Art of Computer Programming</u>, 
Donald Knuth turns to the question of generating permutations for a given
combinatoric system. The book opens with Knuth jumping immediately into 
the problem of generating permutations.</p>
<p>Algorith M is the first algorithm Knuth presents to generate all unique tuples.
To pose the problem a little more clearly, consider a combinatoric system that
has <span class="math">\(n\)</span> independent parts, each part having a number of possible states.
We can completely specify the state of the combinatoric system by specifying
an <span class="math">\(n\)</span>-tuple:</p>
<div class="math">$$
(a_1, a_2, \dots, a_n)
$$</div>
<p>where each independent variable takes on one of its possible values <span class="math">\(0 \leq a_i \leq m_i\)</span>.</p>
<p>Knuth's Algorithm M starts by setting all a's to 0, and incrementing 
the right-most entry of the tuple (carrying if necessary). </p>
<p>This is equivalent to counting in binary from 0 to <span class="math">\(N-1\)</span>,
or to labeling every possible outcome with a number between 0 and <span class="math">\(N-1\)</span>.</p>
<p>This becomes more clear if we consider the <span class="math">\(n\)</span>-tuple to be 
a number in a variable-radix system:</p>
<p>The number is <span class="math">\(\left[ a_1, a_2, \dots, a_n \right]\)</span></p>
<p>The radix is <span class="math">\(\left[ m_1, m_2, \dots, m_n \right]\)</span></p>
<p>By repeatedly adding 1 to the number <span class="math">\(\left[ a_1, a_2, \dots, a_n \right]\)</span>, 
we iterate through every possible tuple <span class="math">\((a_1, a_2, \dots, a_n)\)</span> and 
therefore through every possible combination of the independent variables.</p>
<h2>Knuth's Algorithm M</h2>
<p><strong>Algorithm M</strong> <em>(Mixed-radix generation)</em>. This algorithm visits all <span class="math">\(n\)</span>-tuples that satisfy the number/radix expressions above, by repeatedly adding 1 to the mixed-radix number until overflow occurs. (Aux. variables <span class="math">\(a_0\)</span> and <span class="math">\(m_0\)</span> introduced for convenience only.)</p>
<p><strong>M1.</strong> [Initialize.] Set <span class="math">\(a_j \rightarrow 0\)</span> for <span class="math">\(0 \leq j \leq n\)</span>, set <span class="math">\(m_0 \rightarrow 2\)</span>.</p>
<p><strong>M2.</strong> [Visit.] Visit the <span class="math">\(n\)</span>-tuple <span class="math">\((a_1, \dots, a_n)\)</span>. (The program that wants to examine all <span class="math">\(n\)</span>-tulpes now does its thing.)</p>
<p><strong>M3.</strong> [Prepare to add one.] Set <span class="math">\(j \rightarrow n\)</span>.</p>
<p><strong>M4.</strong> [Carry if necessary.] If <span class="math">\(a_j = m_j - 1\)</span>, set <span class="math">\(a_j \rightarrow 0, j \rightarrow j-1\)</span> and repeat this step.</p>
<p><strong>M5.</strong> [Increase, unless done.] If <span class="math">\(j=0\)</span>, terminate algorithm. Otherwise set <span class="math">\(a_j = a_j + 1\)</span> and go back to step <span class="math">\(M2\)</span>.</p>
<h2>Implementing Algorithm M</h2>
<p>Unfortunately, this pseudocode takes some work to translate. Fortunately, that's already done in the method below.</p>
<p>The method below implements Algorithm M in Python to generate random sequences on a 4x4 Rubik's Cube (called the Rubik's Revenge, or RR for short). The RR cube has six faces that can each be rotated clockwise or counterclockwise by a single layer, denoted by the uppercase letters U, D, B, F, L, R (up, down, back, front, left, right, respectively) for clockwise rotations and U', D', B', F', L', R' for counterclockwise rotations, for 12 total moves.</p>
<p>However, on a 4x4 cube, we can also rotate <em>two</em> layers at a time. (That's the limit; moving three layers at a time is equivalent to a reversed rotation of the remaining single layer.) This type of rotation is denoted with a "w".</p>
<p>Thus, rotating the top two layers of each of the six faces clockwise is denoted Uw, Dw, Bw, Fw, Lw, Rw, and counterclockwise rotations are denoted Uw', Dw', Bw', Fw', Lw', Rw', for 12 additional moves.</p>
<p>We have one more type of move, which is where the second layer only is removed. This type of move is denoted with 2, and the face whose second layer is being rotated, for six moves: 2U, 2D, 2B, 2F, 2L, 2R. The prime notation denotes again a counterclockwise rotation, for an additional six moves: 2U', 2D', 2B', 2F', 2L', 2R'. This yields another 12 moves.</p>
<p>There are 36 total moves that can be executed on the 4x4 Rubik's Revenge cube.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">algorithm_m</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Knuth&#39;s Algorithm M for permutation generation,</span>
<span class="sd">    via AOCP Volume 4 Fascile 2.</span>
<span class="sd">    This is a generator that returns permtuations </span>
<span class="sd">    generated using the variable-radix method. </span>

<span class="sd">    This generates ALL permutations.</span>
<span class="sd">    Many of these are rotations of one another,</span>
<span class="sd">    so use the get_rotations() function</span>
<span class="sd">    (defined later) to eliminate redundant sequences.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">moves</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">]</span>

    <span class="c1"># M1 - Initialize</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,]</span><span class="o">*</span><span class="n">n</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">moves</span><span class="p">),]</span><span class="o">*</span><span class="n">n</span>

    <span class="n">j</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span>

    <span class="n">nvisits</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>

        <span class="c1"># M2 - visit</span>
        <span class="n">move_sequence</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="n">moves</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">aj</span><span class="p">)]</span> <span class="k">for</span> <span class="n">aj</span> <span class="ow">in</span> <span class="n">a</span><span class="p">])</span>
        <span class="k">yield</span> <span class="n">move_sequence</span> 

        <span class="n">nvisits</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># M3 - prepare to +1</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span>

        <span class="c1"># M4 - carry</span>
        <span class="k">while</span><span class="p">(</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span>

        <span class="c1"># M5 - increase unless done</span>
        <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>


<h2>Test Drive</h2>
<p>Let's take a look at how Algorithm M looks when it is applied. 
No surprises here: Algorithm M generates each of the possible 
permutations in sequence.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="c1"># (Algorithm M goes here) </span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">pprint</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">algorithm_m</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
</pre></div>


<p>and the result:</p>
<div class="highlight"><pre><span></span>    [&#39;A A A&#39;,
     &#39;A A B&#39;,
     &#39;A A C&#39;,
     &#39;A A D&#39;,
     &#39;A B A&#39;,
     &#39;A B B&#39;,
     &#39;A B C&#39;,
     &#39;A B D&#39;,
     &#39;A C A&#39;,
     &#39;A C B&#39;,
     &#39;A C C&#39;,
     &#39;A C D&#39;,
     &#39;A D A&#39;,
     &#39;A D B&#39;,
     &#39;A D C&#39;,
     &#39;A D D&#39;,
     &#39;B A A&#39;,
     &#39;B A B&#39;,
     &#39;B A C&#39;,
     &#39;B A D&#39;,
     &#39;B B A&#39;,
     &#39;B B B&#39;,
     &#39;B B C&#39;,
     &#39;B B D&#39;,
     &#39;B C A&#39;,
     &#39;B C B&#39;,
     &#39;B C C&#39;,
     &#39;B C D&#39;,
     &#39;B D A&#39;,
     &#39;B D B&#39;,
     &#39;B D C&#39;,
     &#39;B D D&#39;,
     &#39;C A A&#39;,
     &#39;C A B&#39;,
     &#39;C A C&#39;,
     &#39;C A D&#39;,
     &#39;C B A&#39;,
     &#39;C B B&#39;,
     &#39;C B C&#39;,
     &#39;C B D&#39;,
     &#39;C C A&#39;,
     &#39;C C B&#39;,
     &#39;C C C&#39;,
     &#39;C C D&#39;,
     &#39;C D A&#39;,
     &#39;C D B&#39;,
     &#39;C D C&#39;,
     &#39;C D D&#39;,
     &#39;D A A&#39;,
     &#39;D A B&#39;,
     &#39;D A C&#39;,
     &#39;D A D&#39;,
     &#39;D B A&#39;,
     &#39;D B B&#39;,
     &#39;D B C&#39;,
     &#39;D B D&#39;,
     &#39;D C A&#39;,
     &#39;D C B&#39;,
     &#39;D C C&#39;,
     &#39;D C D&#39;,
     &#39;D D A&#39;,
     &#39;D D B&#39;,
     &#39;D D C&#39;,
     &#39;D D D&#39;]
</pre></div>


<h2>What Other Ways Are There?</h2>
<p>All of this may seem obvious or uninteresting,
if you don't realize there are other ways of 
generating all possible <span class="math">\(n\)</span>-tuples.</p>
<p>It's a bit easier to think about for binary 
numbers. Imagine you're trying to generate 
every possible 10-digit binary number.
This means generating all binary numbers
between <span class="math">\(0\)</span> and <span class="math">\(2^{10}-1\)</span>. </p>
<p>Algorithm M, as we saw above, just counts 
from 0 to <span class="math">\(2^{10}-1\)</span>. But this can involve
changing a large number of bits (for example,
adding 1 to 001111111 results in 010000000,
changing 8 digits. Knuth presents an
alternative algorithm that only requires
changing <em>one</em> bit to generate the next
permutation, making the algorithm much 
faster.</p>
<p>More on that algorithm in a future blog post...</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script></div>

    </div>
</div>

<div class="v20"></div>

<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="tags">
            <p>Tags:&nbsp;&nbsp;&nbsp;
                    <a href="/tag/combinatorics.html">combinatorics</a>
                    &nbsp;&nbsp;
                    <a href="/tag/permutations.html">permutations</a>
                    &nbsp;&nbsp;
                    <a href="/tag/python.html">python</a>
                    &nbsp;&nbsp;
                    <a href="/tag/computer-science.html">computer science</a>
                    &nbsp;&nbsp;
                    <a href="/tag/algorithms.html">algorithms</a>
                    &nbsp;&nbsp;
                    <a href="/tag/art-of-computer-programming.html">art of computer programming</a>
                    &nbsp;&nbsp;
                    <a href="/tag/knuth.html">knuth</a>
                    &nbsp;&nbsp;
        </div>

    </div>
</div>


<div class="v200"></div>

</div>


<script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="/theme/js/bootstrap-3.3.4.js"></script>
<script type="text/javascript" src="/theme/js/d3-3.5.5.js"></script>
<!--
<script type="text/javascript" src="/theme/js/leaflet-0.7.3.js"></script>
<script type="text/javascript" src="/theme/js/leaflet.ajax.min.js"></script>
--><script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="/theme/js/bootstrap-3.3.4.js"></script>

<footer id="contentinfo" class="body">
<p>&nbsp;</p>
<p>&nbsp;</p>
<center>
	<hr />
</center>
<p>&nbsp;</p>
<p style="text-align: center">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-terminal fa-stack-1x fa-inverse"></i>
    </span>
    Made from the command line with vim by 
    <a href="http://charlesreid1.com">charlesreid1</a><br />
    with help from <a href="https://getbootstrap.com/">Bootstrap</a> and <a href="http://getpelican.com">Pelican</a>.
</p>

<br />

<p style="text-align: center">
    <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-creative-commons fa-stack-1x fa-inverse"></i>
    </span>
    </a>
    <br />
    Licensed under the <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 License</a>.
</p>

<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=11611748;
var sc_invisible=1;
var sc_security="9fcba820";
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>

<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="//c.statcounter.com/11611748/0/9fcba820/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</footer><!-- /#contentinfo -->
</body>
</html>