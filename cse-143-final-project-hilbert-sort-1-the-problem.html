<!DOCTYPE html>
<html lang="en">
<head>
        <title>charlesreid1</title>
        <meta charset="utf-8" />

        <!--
        CSS styles
        -->
        <link href="/theme/css/bootstrap.css"       rel="stylesheet" type="text/css">
        <!--
        <link href="/theme/css/cyborg.css"          rel="stylesheet" type="text/css">
        <link href="/theme/css/cosmo.css"           rel="stylesheet" type="text/css">
        <link href="/theme/css/sandstone.css"       rel="stylesheet" type="text/css">
        -->
        <link href="/theme/css/slate.css"              rel="stylesheet" type="text/css">
        <link href="/theme/css/font-awesome.css"       rel="stylesheet" type="text/css"/>
        <link href="/theme/css/pygment-solarized.css"  rel="stylesheet" type="text/css"/>


        <!--
        my CSS styles
        -->
        <link href="/theme/css/main.css"            rel="stylesheet" type="text/css">
        <link href="/theme/css/dox.css"             rel="stylesheet" type="text/css">


        <!--
        include Angular first
        -->
        <script type="text/javascript" src="/theme/js/angular-1.3.15.js"></script>
        <script type="text/javascript" src="/theme/js/skrollr-0.6.29.js"></script>
        <script type="text/javascript" src="/theme/js/d3-3.5.5.js"></script>

        <!--
        this seems like a bad idea.
        but if I don't put jquery first, I get errors about unrecognized $s.
        -->
        <script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>

</head>
<body id="index">
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <!--
            http://www.w3schools.com/bootstrap/bootstrap_case_navigation.asp
            -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span> 
            </button>
            <a href="/" class="navbar-brand">charlesreid1.com</a>
        </div>
        <div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav">

                    <li>
                        <a href="https://charlesreid1.com/projects">Projects</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/wiki">Wiki</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.github.io">Research Blog</a>
                    </li>
                    <li>
                        <a href="http://git.charlesreid1.com/explore">git.charlesreid1.com</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/contact">Contact Me</a>
                    </li>

                </ul>
            </div>
        </div>
    </div>
</nav>


<div class="container">

<header>
<div class="row">


    <div class="col-md-12">
        <div class="headtext" style="text-align: center;">
            <h1><b>
                CSE 143 Final Project: Hilbert Sort: 1. The Problem
            </b></h1>
        
            <p class="lead">
                Posted 
                <time datetime="2017-06-23T16:30:00-07:00" pubdate>Friday 06/23/2017</time>
                in 
                <a href="/category/computer-science.html">Computer Science</a>
                </p>
            <p>
            <span style="font-size: 14px">
                <a href="/cse-143-final-project-hilbert-sort-1-the-problem.html">permalink</a>
            </span>
            </p>
        </div>

    </div>

</div>
</header>


<div class="v50"></div>


<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="entry-content"><h1>Table of Contents</h1>
<p>This is the first in a series of three posts 
detailing the Hilbert Sort problem,
its solution, and its implementation.
This post sets up the problem.</p>
<ul>
<li><a href="#hilbert-motivation">Hilbert Sort: Motivation</a></li>
<li><a href="#hilbert-spacefilling">Hilbert, Peano, and Space-Filling Curves</a></li>
<li><a href="#hilbert-curve">Constructing a Hilbert Curve</a></li>
<li><a href="#hilbert-sort">Performing a Hilbert Sort</a></li>
<li><a href="#hilbert-problem">Problem Statement</a></li>
<li><a href="#references">References</a></li>
</ul>
<p><a name="hilbert-motivation"></a></p>
<h1>Hilbert Sort: Motivation</h1>
<p>In the next few series of posts, we will cover the Hilbert Sort problem,
how it works, and how to implement it.<br>
However, before we describe the problem further, 
let's start with some motivation for solving this problem.</p>
<p>Suppose we're dealing with a very large number of independent objects
on a 2D coordinate grid, each with a coordinate location <span class="math">\((x,y)\)</span>.
(For example, a large population of particles moving in a fluid, or a large number 
of characters on a map in a game.) </p>
<p>Here is our box of particles:</p>
<p><img alt="Box of Particles" src="/images/hilbert1a.png"></p>
<p>Now, suppose that we have more data than can be handled by a single computer,
and we want to arrange the data on different computers. However, we want to 
arrange the data in such a way that we preserve the spatial characteristics
of the data.</p>
<p>If we implement a naive sort method for Cartesian points that sorts points by
x coordinate value, breaking ties with the y coordinate value, 
we end up with points that are neighbors in space, but far away 
in the data container's storage (like an array). 
This is particularly true if there are large crowds of points in the grid.</p>
<p>Here is an illustration of a set of points and their resulting 
storage schema in an array that sorts points by x coordinate.
It shows two purple particles, close by in space, but with<br>
several green particles further away distance-wise but 
not with respect to the x coordinate. The spatial locality
of points is not preserved in the data container, 
so clearly, a better method of sorting and organizing points is needed.</p>
<p><img alt="Bad Schema" src="/images/hilbert1b.png"></p>
<p>An alternative to this schema that yields better locality properties,
but that leads to a much higher cost for sorting points, involves 
iterating over each point, and for each point, finding the closest points to it
in space. However, this itself requires iterating over each point.
This approach ends up walking over each point (the point whose nearest neighbors we are finding),
and doing a second nested walk over each point (checking if a point is a nearest neighbor
to this one). The overall cost of doing this is <span class="math">\(O(N^2)\)</span>.</p>
<p>It is a deceptively tricky problem: how to organize a large group of points 
in a way that preserves spatial locality?</p>
<p>But first, we'll cover the topic of space filling curves, then return to this topic.</p>
<p><a name="hilbert-spacefilling"></a></p>
<h1>Space Filling Curves</h1>
<p>Mathematician Giuseppe Peano was a prolific teacher and researcher known for many things,
but one of his more curious ideas is known as the Peano Curve. Peano was attempting to
answer the question of whether a continuous curve could be bounded by a finite space,
and he invented a counter-example: a recipe for breaking a curve into parts
that can be replicated and repeated and applied to the copies as many times as 
desired, and always result in a continuous curve.</p>
<p>The way that space-filling curves in general are constructed is to 
create a pattern, then scale it down and repeat it, 
attaching subsequent scaled-down, repeated curves.
Peano simply invented the first curve; there are many variations 
on the original space-filling curve idea (including the Hilbert Curve - 
more on that in a moment).</p>
<p>The <a href="/files/PeanoCurve.pdf">original 1890 paper by Giuseppe Peano</a> is entitled "Sur une courbe,
qui remplit toute une aire plane", published in 1890 in Mathematische Annalen I, 
Issue 36. Unfortunately, it has no pictures, but here is a rendering from 
Wikimedia Commons:</p>
<p><img alt="Peano Curve" src="/images/PeanoCurve-Many.png"></p>
<p><a href="https://commons.wikimedia.org/wiki/File:Peano_curve.png">(Link to original on Mediawiki Commons)</a></p>
<p>Now, the Peano curve was nice, but it had some mathematical properties 
that made it difficult to deal with. So in 1890,
<a href="/files/HilbertCurve.pdf">David Hilbert published a follow-up paper</a> 
in Mathematische Annalen I Issue 38, entitled 
"Ueber die stetige Abbildung einer Linie auf ein Flächenstück",
which slightly modified the recipe to create a curve with more 
elegant mathematical properties. </p>
<p>Also, he included pictures.</p>
<p>Here is the first figure from Hilbert's paper:</p>
<p><img alt="Hilbert Curve" src="/images/HilbertCurve-OriginalPaper.png"></p>
<p>And here is a slightly cleaner rendering of the Hilbert Curve pattern 
repeated six times:</p>
<p><img alt="Hilbert Curve" src="/images/HilbertCurve-Many.png"></p>
<p><a href="https://commons.wikimedia.org/wiki/File:Hilbert_curve.svg">(Link to original on Wikimedia Commons)</a></p>
<p>From the abstract of Hilbert's paper:</p>
<blockquote>
Peano has recently shown in the Mathematical Annals, 2 by an arithmetical observation, 
how the points of a line can be mapped continuously to the points of a surface part. 
The functions required for such a mapping can be produced more clearly by using the 
following geometrical view. Let us divide the line to be represented-about a straight 
line of the length 1-into four equal parts 1, 2, 3, 4, and the surface which we assume 
in the form of a square of the side length 1 Straight into 4 equal squares 1, 2, 3, 4 
(Fig. 1). Secondly, we divide each of the partial sections 1, 2, 3, 4 again into 4 equal
parts so that we obtain on the straight the 16 partial sections 1, 2, 3, ..., 16; At the 
same time, each of the 4 squares 1, 2, 3, 4 is divided into 4 equal squares, and the numbers 
1, 2, ..., 16 are then written to the resulting 16 squares, That each successive square 
follows the previous one with one side (Fig. 2). If we think of this method, as shown in 
Fig. 3, the next step, it is easy to see how to assign a single definite point of the 
square to any given point of the line. It is only necessary to determine the partial 
stretches of the line to which the given point falls. The squares indicated by the same 
numbers are necessarily in one another and include a certain point of the surface piece 
in the boundary. This is the point assigned to the given point. The image thus found is 
unambiguous and continuous, and vice versa, each point of the square corresponds to 
one, two, or four points of the line. Moreover, it appears remarkable that, by a 
suitable modification of the partial lines in the squares, a clear and continuous 
representation can easily be found, the reversal of which is nowhere more than 
three-fold.

<br />

- David Hilbert, "Über die stetige Abbildung einer Linie auf ein Flächenstück", Mathematische Annalen Vol 38 

</blockquote>

<p>Thanks to Google Translate for an incredible job.</p>
<p><a name="hilbert-curve"></a></p>
<h1>Constructing a Hilbert Curve</h1>
<p>To construct a Hilbert curve, you just have to follow the recipe.
It doesn't matter what your square contains so far,
or how many levels in you are, whether it's the first curve
or the five hundredth:</p>
<ol>
<li>
<p>First, take yer square. </p>
</li>
<li>
<p>Second, quadruple yer square. That means, make four copies, that all make a square.</p>
</li>
<li>
<p>Now rotate the bottom left and bottom right via diagonal reflection.</p>
</li>
<li>
<p>Fourth step is, you're done - that's you're new square!</p>
</li>
</ol>
<p><a name="hilbert-sort"></a></p>
<h1>Performing a Hilbert Sort</h1>
<p>We will omit a proof of the statement, but given a set of unique (x,y) points,
we can always construct a minimal-size Hilbert Curve that visits each point only
once. </p>
<p>Points can be sorted, then, according to when they would be visited by 
said Hilbert Curve. And this ordering provides better preservation of spatial 
locality and structure of points when aligning them in memory, because 
these space-filling curves are recursive and preserve spatial locality
in a top-down fashion.</p>
<p>For example, if we have two points in our square, one in the lower left 
and one in the lower right, and we are sorting them via a Hilbert Sort,
we definitely know that a Hilbert curve constructed to visit both of these points
will definitely visit the lower left point (the quadrant where the Hilbert curve starts)
before it visits the lower right point (in the quadrant where the Hilbert curve stops).</p>
<p>This requires thinking about <span class="math">\((x,y)\)</span> points in the box in terms of quadrants, 
and the order in which the Hilbert curve will visit each quadrant or region,
rather than thinking in terms of the explicit Hilbert curve that will visit each 
particular <span class="math">\((x,y)\)</span> point:</p>
<p><img alt="Box of Particles, Divided Into Quadrants" src="/images/hilbert2a.png"></p>
<p>This is a subtle shift in the thinking about this problem, but it is crucial
to a successful implementation of a Hilbert sort. The problem that will follow,
which asks to implement the Hilbert sort, has many distracting details, 
including the Hilbert curve itself. </p>
<p><strong>Remember, in Hilbert sort, the end goal is not the curve itself, but the sort order.</strong></p>
<p><a name="hilbert-problem"></a></p>
<h1>Problem Statement</h1>
<p>Following is a paraphrased problem statement from the <a href="/files/HilbertSort.pdf">original
ACM ICPC Regional Programming Competition
problem statement</a> that this problem and its solution was based on.</p>
<p>"If points <span class="math">\((x,y)\)</span> are sorted primarily by x, breaking ties by y, then points that are 
adjacent in memory will have similar x coordinates but not necessarily similar y,
potentially placing them far apart on the grid. To better preserve distances, we may 
sort the data along a continuous space-filling curve.</p>
<p>"We consider one such space-filling curve called the Hilbert curve...</p>
<p>"Given some locations of interest, you are asked to sort them according to when the 
Hilbert curve visits them. Note that while the curve intersects itself at 
infinitely many places, e.g., at <span class="math">\((\frac{S}{2}, \frac{S}{2})\)</span>, making S odd 
guarantees all integer points are visited just once."</p>
<p>Here is an example input file, giving a set of points 
on an <span class="math">\(M \times N\)</span> grid:</p>
<div class="highlight"><pre><span></span>    14 25
    5 5 Honolulu
    5 10 PugetSound
    5 20 Victoria
    10 5 Berkeley
    10 10 Portland
    10 15 Seattle
    10 20 Vancouver
    15 5 LasVegas
    15 10 Sacramento
    15 15 Kelowna
    15 20 PrinceGeorge
    20 5 Phoenix
    20 10 SaltLakeCity
    20 20 Calgary
</pre></div>


<p>The corresponding output can be verified intuitively,
assuming the coordinates given above are accurate!
Here is the output. Indeed, the order in which each
city is visited is what we would expect if we drew
a space-filling Hilbert curve over a map of the western
United States and Canada.</p>
<div class="highlight"><pre><span></span>    Honolulu
    Berkeley
    Portland
    PugetSound
    Victoria
    Vancouver
    Seattle
    Kelowna
    PrinceGeorge
    Calgary
    SaltLakeCity
    Sacramento
    LasVegas
    Phoenix
</pre></div>


<p>Now that we've used up all of our space here describing the problem,
in a follow-up post we will go into greater detail about
how to solve the problem conceptually, and come up with some 
pseudocode for a recursive method (since this is a recursive task).
Then, a third post will go into greater detail about the 
final Java code to perform this task.</p>
<p><a name="hilbert-refs"></a></p>
<h1>References</h1>
<ol>
<li>
<p>"ACM Pacific Region Programming Competition." Association of Computing Machinery. 19 June 2017.
&lt;<a href="http://acmicpc-pacnw.org/">http://acmicpc-pacnw.org/</a>&gt;</p>
</li>
<li>
<p>"Sur une courbe, qui remplit toute une aire plane." G. Peano. 
<strong>Mathematische Annalen</strong> 36 (1890), 157–160. <a href="/files/PeanoCurve.pdf">(pdf)</a></p>
</li>
<li>
<p>"Über die stetige Abbildung einer Linie auf ein Flächenstück." D. Hilbert. 
<strong>Mathematische Annalen</strong> 38 (1891), 459–460. <a href="/files/HilbertCurve.pdf">(pdf)</a></p>
</li>
<li>
<p>"Hilbert Curve." Wikipedia: The Free Encyclopedia. Wikimedia Foundation. Edited 29 April 2017. Accessed 23 June 2017.
&lt;<a href="https://en.wikipedia.org/wiki/Hilbert_curve">https://en.wikipedia.org/wiki/Hilbert_curve</a>&gt;</p>
</li>
<li>
<p>"Peano Curve." Wikipedia: The Free Encyclopedia. Wikimedia Foundation. Edited 16 October 2016. Accessed 23 June 2017.
&lt;<a href="https://en.wikipedia.org/wiki/Peano_curve">https://en.wikipedia.org/wiki/Peano_curve</a>&gt;</p>
</li>
</ol>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script></div>

    </div>
</div>

<div class="v20"></div>

<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="tags">
            <p>Tags:&nbsp;&nbsp;&nbsp;
                    <a href="/tag/programming.html">programming</a>
                    &nbsp;&nbsp;
                    <a href="/tag/computer-science.html">computer science</a>
                    &nbsp;&nbsp;
                    <a href="/tag/final-project.html">final project</a>
                    &nbsp;&nbsp;
                    <a href="/tag/competitive-programming.html">competitive programming</a>
                    &nbsp;&nbsp;
        </div>

    </div>
</div>


<div class="v200"></div>

</div>


<script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="/theme/js/bootstrap-3.3.4.js"></script>
<script type="text/javascript" src="/theme/js/d3-3.5.5.js"></script>
<!--
<script type="text/javascript" src="/theme/js/leaflet-0.7.3.js"></script>
<script type="text/javascript" src="/theme/js/leaflet.ajax.min.js"></script>
--><footer id="contentinfo" class="body">
<p>&nbsp;</p>
<p>&nbsp;</p>
<center>
	<hr />
</center>
<p>&nbsp;</p>
<p style="text-align: center">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-terminal fa-stack-1x fa-inverse"></i>
    </span>
    Made from the command line with vim by
    <a href="http://charlesreid1.com">charlesreid1</a><br />
    with help from <a href="http://d3js.org">D3.js</a>, <a href="http://angular.io">Angular.js</a>, and <a href="http://getpelican.com">Pelican</a>.
</p>

<br />

<p style="text-align: center">
    <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-creative-commons fa-stack-1x fa-inverse"></i>
    </span>
    </a>
    <br />
    Licensed under the <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 License</a>.
</p>

</footer><!-- /#contentinfo -->

<script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="/theme/js/jquery_load_template-1.4.5.min.js"></script>
<script type="text/javascript" src="/theme/js/bootstrap-3.3.4.js"></script>

</footer><!-- /#contentinfo -->
</body>
</html>