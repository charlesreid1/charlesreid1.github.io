<!DOCTYPE html>
<html lang="en">
<head>
        <title>charlesreid1</title>
        <meta charset="utf-8" />

        <!--
        CSS styles
        -->
        <link href="/theme/css/bootstrap.css"       rel="stylesheet" type="text/css">
        <!--
        <link href="/theme/css/cyborg.css"          rel="stylesheet" type="text/css">
        <link href="/theme/css/cosmo.css"           rel="stylesheet" type="text/css">
        <link href="/theme/css/sandstone.css"       rel="stylesheet" type="text/css">
        -->
        <link href="/theme/css/slate.css"              rel="stylesheet" type="text/css">
        <link href="/theme/css/font-awesome.css"       rel="stylesheet" type="text/css"/>
        <link href="/theme/css/pygment-solarized.css"  rel="stylesheet" type="text/css"/>


        <!--
        my CSS styles
        -->
        <link href="/theme/css/main.css"            rel="stylesheet" type="text/css">
        <link href="/theme/css/dox.css"             rel="stylesheet" type="text/css">


        <!--
        include Angular first
        -->
        <script type="text/javascript" src="/theme/js/angular-1.3.15.js"></script>
        <script type="text/javascript" src="/theme/js/skrollr-0.6.29.js"></script>
        <script type="text/javascript" src="/theme/js/d3-3.5.5.js"></script>

        <!--
        this seems like a bad idea.
        but if I don't put jquery first, I get errors about unrecognized $s.
        -->
        <script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>

</head>
<body id="index">
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <!--
            http://www.w3schools.com/bootstrap/bootstrap_case_navigation.asp
            -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span> 
            </button>
            <a href="https://charlesreid1.com/" class="navbar-brand">charlesreid1.com</a>
        </div>
        <div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav">

                    <li>
                        <a href="https://charlesreid1.com/projects">Projects</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/wiki">Wiki</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.github.io">Research Blog</a>
                    </li>
                    <li>
                        <a href="http://git.charlesreid1.com/explore">git.charlesreid1.com</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/contact">Contact Me</a>
                    </li>

                </ul>
            </div>
        </div>
    </div>
</nav>


<div class="container">

<header>
<div class="row">


    <div class="col-md-12">
        <div class="headtext" style="text-align: center;">
            <h1><b>
                Computing Square Roots: Part 1: Using Newton's Method
            </b></h1>
        
            <p class="lead">
                Posted 
                <time datetime="2017-07-14T20:00:00-07:00" pubdate>Friday 07/14/2017</time>
                in 
                <a href="/category/numerics.html">Numerics</a>
                </p>
            <p>
            <span style="font-size: 14px">
                <a href="/computing-square-roots-part-1-using-newtons-method.html">permalink</a>
            </span>
            </p>
        </div>

    </div>

</div>
</header>


<div class="v50"></div>


<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="entry-content"><h2>Table of Contents</h2>
<ul>
<li>
<p><a href="#newton-roots">Newton's Method for Finding Roots of Equations</a></p>
</li>
<li>
<p><a href="#newton-square-roots">Newton's Method for Finding Square Roots</a></p>
</li>
<li>
<p><a href="#newton-program">Newton's Method for Finding Square Roots: Program</a></p>
</li>
<li>
<p><a href="#newton-accuracy">Accuracy</a></p>
</li>
<li>
<p><a href="#newton-speed">Speed</a></p>
</li>
<li>
<p><a href="#newton-next">Next Steps</a></p>
</li>
</ul>
<p><a name="newton-roots"></a></p>
<h2>Newton's Method for Finding Roots of Equations</h2>
<p>Suppose we have a function <span class="math">\(f(x)\)</span> and we want to 
compute values of <span class="math">\(x\)</span> for which <span class="math">\(f(x)=0\)</span>. These values 
of <span class="math">\(x\)</span> are called the <strong>roots</strong> of <span class="math">\(f(x)\)</span>.</p>
<p>We can compute the roots using Newton's Method,
which utilizes the derivative of the function
to iteratively compute the roots of the function.</p>
<p>Newton's method begins with an initial guess.
It evaluates the derivative of the fnction at the 
initial guess, which gives the slope of the tangent line,
and computes the root of the tangent line as the next
approximation of the root of the function.</p>
<p>This is based on the point-slope formula,</p>
<div class="math">$$
y - y_0 = m(x - x_0) 
$$</div>
<p>Now the left side becomes </p>
<div class="math">$$
f(x) - f(x_0) = f'(x_0)(x - x_0)
$$</div>
<p>and at the root, we know <span class="math">\(f(x)=0\)</span>, so rearranging this equation
into an expression for the root <span class="math">\(x\)</span> gives: </p>
<div class="math">$$
x = x_0 - \dfrac{f(x_0)}{f'(x_0)}
$$</div>
<p>Now, this is the equation for the next approximation for the root.
To turn this into an iterative procedure, we write this as</p>
<div class="math">$$
x_{i+1} = x_{i} - \dfrac{f(x_i)}{f'(x_i)}
$$</div>
<p>Newton's Method then allows us to evaluate the 
above expression as many times as we would like
to achive the desired accuracy. </p>
<p>Two caveats with Newton's Method: </p>
<ul>
<li>The function must be relatively well-behaved; 
    Newton's Method does not converge for functions with
    large, high-order derivatives.</li>
<li>The convergence of the method depends on the accuracy 
    of the initial guess. If you can make a good guess, do it!</li>
</ul>
<p><a name="newton-square-roots"></a></p>
<h2>Newton's Method for Finding Square Roots</h2>
<p>Note that we can use the procedure and equation from above
to compute the numerical value of a given function to an arbitrary
degree of accuracy, so long as we have the derivative (and a program 
that can keep track of arbitrary digits).</p>
<p>Suppose we want to use Newton's Method to compute <span class="math">\(\sqrt{2}\)</span>.
Then we can solve for the roots of the following function:</p>
<div class="math">$$
f(x) = x^2 - a
$$</div>
<p>for <span class="math">\(a = 2\)</span>.</p>
<p>Note that the derivative of this function is computed using the power rule,
which is trivial to implement, so we can also use this method to compute
general <span class="math">\(n^{th}\)</span> roots of <span class="math">\(a\)</span>, by solving for roots of:</p>
<div class="math">$$
f(x) = x^n - a
$$</div>
<p>For a monomial with nonzero power, the derivative is always l<span class="math">\(f'(x) = n x^{n-1}\)</span>, 
so in the square root case we have <span class="math">\(f'(x) = 2x\)</span>. Now we plug these two functions
into the iterative formula for Newton's Method to get:</p>
<div class="math">$$
\begin{array}
a x_{i+1} &amp;=&amp; x_{i} - \dfrac{f(x_n)}{f'(x_n)} \\
x_{i+1} &amp;=&amp; x_{i} - \dfrac{x_i^2 - a}{2 x_i }
\end{array}
$$</div>
<p><a name="newton-program"></a></p>
<h2>Newton's Method for Finding Square Roots: Program</h2>
<p>This can be implemented in a programming language to yield an iterative
method for computing square roots. We can either specify a tolerance (better),
or a number of iterations. Here is a static method for computing
a square root using Newton's method. The user specifies the value of <span class="math">\(a\)</span>,
the number they want to compute the square root of; <span class="math">\(x_0\)</span>, the initial guess;
and a tolerance, which controls the number of decimal places of accuracy of the 
final answer.</p>
<div class="highlight"><pre><span></span>    <span class="cm">/** Compute a square root using Newton&#39;s Method, to a specified tolerance.</span>
<span class="cm">     *</span>
<span class="cm">     * @param a Compute the square root of a.</span>
<span class="cm">     * @param x0 Initial guess.</span>
<span class="cm">     * @param tol Tolerance (stopping criteria).</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">nmsqrttol</span><span class="o">(</span><span class="kt">double</span> <span class="n">a</span><span class="o">,</span> <span class="kt">double</span> <span class="n">x0</span><span class="o">,</span> <span class="kt">double</span> <span class="n">tol</span><span class="o">)</span> <span class="o">{</span> 
        <span class="kt">double</span> <span class="n">xi</span><span class="o">,</span> <span class="n">xip1</span><span class="o">,</span> <span class="n">err</span><span class="o">;</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">xip1</span> <span class="o">=</span> <span class="n">x0</span><span class="o">;</span>
        <span class="n">err</span> <span class="o">=</span> <span class="n">x0</span><span class="o">;</span>
        <span class="k">while</span><span class="o">(</span><span class="n">err</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="o">)</span> <span class="o">{</span> 
            <span class="n">xip1</span> <span class="o">=</span> <span class="n">xi</span> <span class="o">-</span> <span class="o">(</span><span class="n">xi</span><span class="o">*</span><span class="n">xi</span><span class="o">-</span><span class="n">a</span><span class="o">)/(</span><span class="mi">2</span><span class="o">*</span><span class="n">xi</span><span class="o">);</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span> <span class="n">xip1</span> <span class="o">-</span> <span class="n">xi</span> <span class="o">);</span>
            <span class="n">xi</span> <span class="o">=</span> <span class="n">xip1</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">xip1</span><span class="o">;</span>
    <span class="o">}</span>
</pre></div>


<p>(There is no check for infinite loops because our function is a smooth
polynomial and Newton's Method will always converge.) </p>
<p>Here is sample output from a program that varies the tolerance and prints
the corresponding value of the square root that was computed:</p>
<div class="highlight"><pre><span></span>javac SquareRoot.java &amp;&amp; java SquareRoot
Actual value sqrt(2) = 1.4142135623730951
Testing Newton&#39;s Method, Specifying Tolerance:
Tol         sqrt(2)
0.1         1.4166666666666667
0.01        1.4142156862745099
0.001       1.4142135623746899
0.0001      1.4142135623746899
1e-05       1.4142135623746899
1e-06       1.4142135623730951
1e-07       1.4142135623730951
1e-08       1.4142135623730951
</pre></div>


<p><a name="newton-accuracy"></a></p>
<h2>Accuracy</h2>
<p>Now that we've coded up Newton's Method, we can determine the number of accurate 
digits. There are a couple of ways to do this, but I went with a string comparison 
method. I start with a text file containing thousands of digits of the square root of 2,
then I compute the square root of 2 using Newton's Method. The longest common substring
gives me the number of accurate digits, plus "1.", so if I subtract 2 I get the 
total number of accurate digits after the decimal place. </p>
<div class="highlight"><pre><span></span>javac SquareRoot.java &amp;&amp; java SquareRoot
Tolerance = 0.1     Number of accurate digits = 2
Tolerance = 0.01        Number of accurate digits = 5
Tolerance = 0.001       Number of accurate digits = 11
Tolerance = 0.0001      Number of accurate digits = 11
Tolerance = 1e-05       Number of accurate digits = 11
Tolerance = 1e-06       Number of accurate digits = 15
Tolerance = 1e-07       Number of accurate digits = 15
Tolerance = 1e-08       Number of accurate digits = 15
Tolerance = 1e-09       Number of accurate digits = 15
Tolerance = 1e-10       Number of accurate digits = 15
Tolerance = 1e-11       Number of accurate digits = 15
Tolerance = 1e-12       Number of accurate digits = 15
Tolerance = 1e-13       Number of accurate digits = 15
Tolerance = 1e-14       Number of accurate digits = 15
</pre></div>


<p><a name="newton-speed"></a></p>
<h2>Speed</h2>
<p>It is also important to measure performance, in the form of speed. How fast is 
Newton's Method relative to the built-in square root function in the math library?</p>
<p>Turns out the performance of Newton's Method is much worse than the built-in math library's 
square root function. The Newton's Method defined above is around 100 times slower. 
Here are the results of a simple timing test, in which we compute the square root
10 million times, timing how long it takes, and divide by the number of operations
to yield the time per operation (or rather, as it is slightly easier to grasp, 
the time per 1k operations);:</p>
<div class="highlight"><pre><span></span>    <span class="c">/** Time Newton&#39;s Method.</span>
<span class="c">     *</span>
<span class="c">     * How long does it take to achieve 10 digits of accuracy? */</span>
    <span class="nt">public</span> <span class="nt">static</span> <span class="nt">void</span> <span class="nt">testTime</span><span class="o">()</span> <span class="p">{</span> 

        <span class="err">int</span> <span class="err">Nops</span><span class="p">;</span>
        <span class="err">double</span> <span class="err">a</span><span class="p">;</span>
        <span class="err">double</span> <span class="err">initialGuess</span><span class="p">;</span>
        <span class="err">double</span> <span class="err">tol</span><span class="p">;</span>
        <span class="err">double</span> <span class="err">time</span><span class="p">;</span>

        <span class="err">Tim</span> <span class="err">tim</span><span class="p">;</span>

        <span class="err">Nops</span> <span class="err">=</span> <span class="err">10000000</span><span class="p">;</span>
        <span class="err">a</span> <span class="err">=</span> <span class="err">2</span><span class="p">;</span>
        <span class="err">initialGuess</span> <span class="err">=</span> <span class="err">1</span><span class="p">;</span>
        <span class="err">tol</span> <span class="err">=</span> <span class="err">1E-8</span><span class="p">;</span>
        <span class="err">tim</span> <span class="err">=</span> <span class="err">new</span> <span class="err">Tim()</span><span class="p">;</span>
        <span class="err">tim.tic()</span><span class="p">;</span>
        <span class="err">for(int</span> <span class="err">i=0</span><span class="p">;</span> <span class="err">i&lt;Nops</span><span class="p">;</span> <span class="err">i++)</span> <span class="err">{</span> 
            <span class="err">nmsqrttol(a,</span> <span class="err">initialGuess,</span> <span class="err">tol)</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nt">tim</span><span class="p">.</span><span class="nc">toc</span><span class="o">();</span>
        <span class="nt">time</span> <span class="o">=</span> <span class="nt">1000</span><span class="o">*</span><span class="nt">tim</span><span class="p">.</span><span class="nc">elapsedms</span><span class="o">()/</span><span class="nt">Nops</span><span class="o">;</span>
        <span class="nt">System</span><span class="p">.</span><span class="nc">out</span><span class="p">.</span><span class="nc">println</span><span class="o">(</span><span class="s2">&quot;Newton&#39;s Method Time (ms) per 1k operations: &quot;</span><span class="o">+</span><span class="nt">time</span><span class="o">);</span>


        <span class="nt">Nops</span> <span class="o">=</span> <span class="nt">10000000</span><span class="o">;</span>
        <span class="nt">a</span> <span class="o">=</span> <span class="nt">2</span><span class="o">;</span>
        <span class="nt">tim</span> <span class="o">=</span> <span class="nt">new</span> <span class="nt">Tim</span><span class="o">();</span>
        <span class="nt">tim</span><span class="p">.</span><span class="nc">tic</span><span class="o">();</span>
        <span class="nt">for</span><span class="o">(</span><span class="nt">int</span> <span class="nt">i</span><span class="o">=</span><span class="nt">0</span><span class="o">;</span> <span class="nt">i</span><span class="o">&lt;</span><span class="nt">Nops</span><span class="o">;</span> <span class="nt">i</span><span class="o">++)</span> <span class="p">{</span> 
            <span class="err">Math.sqrt(a)</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nt">tim</span><span class="p">.</span><span class="nc">toc</span><span class="o">();</span>
        <span class="nt">time</span> <span class="o">=</span> <span class="nt">1000</span><span class="o">*</span><span class="nt">tim</span><span class="p">.</span><span class="nc">elapsedms</span><span class="o">()/</span><span class="nt">Nops</span><span class="o">;</span>
        <span class="nt">System</span><span class="p">.</span><span class="nc">out</span><span class="p">.</span><span class="nc">println</span><span class="o">(</span><span class="s2">&quot;Math Library Time (ms) per 1k operations: &quot;</span><span class="o">+</span><span class="nt">time</span><span class="o">);</span>

    <span class="err">}</span>
</pre></div>


<p>and the results:</p>
<div class="highlight"><pre><span></span>javac SquareRoot.java &amp;&amp; java SquareRoot
Newton&#39;s Method Time (ms) per 1k operations: 0.016
Math Library Time (ms) per 1k operations: 3.0E-4
</pre></div>


<p>While the accuracy of Newton's Method for square roots may not be that great,
it ain't bad, for 9 lines of code. </p>
<p><a name="newton-next"></a></p>
<h2>Next Steps</h2>
<p>In a blog post to follow, we'll compare the speed and accuracy of square root computations using Newton's Method
to an alternative approach involving the continued fraction representation of square roots. This particularly interesting
technique can also be used to solve the Pell equation, a quadratic Diophantine equation of the form:</p>
<div class="math">$$
x^2 - D y^2 = 1
$$</div>
<p>But more on that in a future post...</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script></div>

    </div>
</div>

<div class="v20"></div>

<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="tags">
            <p>Tags:&nbsp;&nbsp;&nbsp;
                    <a href="/tag/computer-science.html">computer science</a>
                    &nbsp;&nbsp;
                    <a href="/tag/java.html">java</a>
                    &nbsp;&nbsp;
                    <a href="/tag/mathematics.html">mathematics</a>
                    &nbsp;&nbsp;
                    <a href="/tag/square-roots.html">square roots</a>
                    &nbsp;&nbsp;
                    <a href="/tag/numerical-methods.html">numerical methods</a>
                    &nbsp;&nbsp;
                    <a href="/tag/newtons-method.html">newtons method</a>
                    &nbsp;&nbsp;
        </div>

    </div>
</div>


<div class="v200"></div>

</div>


<script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="/theme/js/bootstrap-3.3.4.js"></script>
<script type="text/javascript" src="/theme/js/d3-3.5.5.js"></script>
<!--
<script type="text/javascript" src="/theme/js/leaflet-0.7.3.js"></script>
<script type="text/javascript" src="/theme/js/leaflet.ajax.min.js"></script>
--><footer id="contentinfo" class="body">
<p>&nbsp;</p>
<p>&nbsp;</p>
<center>
	<hr />
</center>
<p>&nbsp;</p>
<p style="text-align: center">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-terminal fa-stack-1x fa-inverse"></i>
    </span>
    Made from the command line with vim by
    <a href="http://charlesreid1.com">charlesreid1</a><br />
    with help from <a href="http://d3js.org">D3.js</a>, <a href="http://angular.io">Angular.js</a>, and <a href="http://getpelican.com">Pelican</a>.
</p>

<br />

<p style="text-align: center">
    <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-creative-commons fa-stack-1x fa-inverse"></i>
    </span>
    </a>
    <br />
    Licensed under the <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 License</a>.
</p>

</footer><!-- /#contentinfo -->

<script type="text/javascript" src="/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="/theme/js/jquery_load_template-1.4.5.min.js"></script>
<script type="text/javascript" src="/theme/js/bootstrap-3.3.4.js"></script>

</footer><!-- /#contentinfo -->
</body>
</html>