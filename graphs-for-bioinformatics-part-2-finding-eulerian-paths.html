<!DOCTYPE html>
<html lang="en">
<head>
        <title>charlesreid1</title>
        <meta charset="utf-8" />

        <!--
        CSS styles
        -->
        <link href="http://localhost:8000/theme/css/bootstrap.css"       rel="stylesheet" type="text/css">
        <link href="http://localhost:8000/theme/css/slate.css"              rel="stylesheet" type="text/css">
        <link href="http://localhost:8000/theme/css/font-awesome.css"       rel="stylesheet" type="text/css"/>
        <link href="http://localhost:8000/theme/css/pygment-solarized.css"  rel="stylesheet" type="text/css"/>

        <!--
        my CSS styles
        -->
        <link href="http://localhost:8000/theme/css/main.css"            rel="stylesheet" type="text/css">
        <link href="http://localhost:8000/theme/css/dox.css"             rel="stylesheet" type="text/css">


        <!--
        include Angular first
        -->
        <script type="text/javascript" src="http://localhost:8000/theme/js/angular-1.3.15.js"></script>
        <script type="text/javascript" src="http://localhost:8000/theme/js/skrollr-0.6.29.js"></script>
        <script type="text/javascript" src="http://localhost:8000/theme/js/d3-3.5.5.js"></script>

        <!--
        this seems like a bad idea.
        but if I don't put jquery first, I get errors about unrecognized $s.
        -->
        <script type="text/javascript" src="http://localhost:8000/theme/js/jquery-1.11.2.js"></script>

</head>
<body id="index">
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span> 
            </button>
            <a href="https://charlesreid1.github.io" class="navbar-brand">charlesreid1.github.io</a>
        </div>
        <div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav">

                    <li>
                        <a href="https://charlesreid1.com/wiki">Wiki</a>
                    </li>
                    <li>
                        <a href="https://git.charlesreid1.com/explore">Git</a>
                    </li>
                    <li>
                        <a href="http://spotify.charlesreid1.com">Music</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/life">Life</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.github.io">Blog</a>
                    </li>
                    <li>
                        <a href="https://charlesreid1.com/about">About Me</a>
                    </li>

                </ul>
            </div>
        </div>
    </div>
</nav>



<div class="container">

<header>
<div class="row">


    <div class="col-md-12">
        <div class="headtext" style="text-align: center;">
            <h1><b>
                Graphs for Bioinformatics, Part 2: Finding Eulerian Paths
            </b></h1>
        
            <p class="lead">
                Posted 
                <time datetime="2019-05-07T16:00:00-07:00" pubdate>Tuesday 05/07/2019</time>
                in 
                <a href="http://localhost:8000/category/computational-biology.html">Computational Biology</a>
                </p>
            <p>
            <span style="font-size: 14px">
                <a href="http://localhost:8000/graphs-for-bioinformatics-part-2-finding-eulerian-paths.html">permalink</a>
            </span>
            </p>
        </div>

    </div>

</div>
</header>


<div class="v50"></div>


<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="entry-content"><h1 id="table-of-contents">Table of Contents</h1>
<ul>
<li><a href="#the-context-de-bruijn-graphs">The Context: de Bruijn Graphs</a></li>
<li><a href="#assembling-the-de-bruijn-graph">Assembling the de Bruijn Graph</a><ul>
<li><a href="#directed-graph-representation-adjacency-list">Directed Graph Representation: Adjacency List</a></li>
<li><a href="#a-quick-example">A Quick Example</a></li>
<li><a href="#python-vs-go">Python vs. Go</a></li>
<li><a href="#directed-graph-class-python-implementation">Directed Graph Class: Python Implementation</a></li>
</ul>
</li>
<li><a href="#checking-for-eulerian-paths-and-cycles">Checking for Eulerian Paths and Cycles</a></li>
<li><a href="#algorithm-building-blocks">Algorithm Building Blocks</a><ul>
<li><a href="#depth-first-search">Depth First Search</a></li>
<li><a href="#kosarajus-algorithm-connected-components">Kosaraju's Algorithm: Connected Components</a></li>
</ul>
</li>
<li><a href="#finding-the-eulerian-path-or-cycle">Finding the Eulerian Path or Cycle</a><ul>
<li><a href="#hierholzers-algorithm-finding-euler-cycles">Hierholzer's Algorithm: Finding Euler Cycles</a></li>
<li><a href="#hierholzers-algorithm-finding-euler-paths">Hierholzer's Algorithm: Finding Euler Paths</a></li>
</ul>
</li>
<li><a href="#final-code">Final Code</a></li>
</ul>
<p><br />
<br /></p>
<h1 id="the-context-de-bruijn-graphs">The Context: de Bruijn Graphs</h1>
<p>In <a href="https://charlesreid1.github.io/graphs-for-bioinformatics-part-1-de-bruijn-graphs-hamiltonian-paths-and-eulerian-paths.html">Part 1 of this post</a>
we discussed a data structure called a de Bruijn graph and covered its application
to genome assembly. To summarize, a de Bruijn graph is a type of graph that represents
a set of k-mers as a set of directed edges on a graph, connecting the k-mer's (k-1)-mer prefix
(the source vertex) to the k-mer's (k-1)-mer suffix (the destination vertex).</p>
<p>As an example, if <span class="math">\(k = 5\)</span>, we can represent the k-mer "AAGCT" as an edge connecting the vertex
<code>AAGC</code> to the vertex <code>AGCT</code>.</p>
<p>The de Bruijn graph is used to solve a set of problems on <a href="https://rosalind.info">Rosalind.info</a>,
a website with bioinformatics programming challenges, as part of working through the
textbook <a href="http://bioinformaticsalgorithms.com/">Bioinformatics Algorithms: An Active Learning Approach</a>
and its associated website (<a href="https://rosalind.info">Rosalind.info</a>).</p>
<h1 id="assembling-the-de-bruijn-graph">Assembling the de Bruijn Graph</h1>
<p>The problems from Rosalind.info that require the use of a de Bruijn graph come from
Chapter 3. These problems generally give the user either a list of k-mers (to assemble
into a de Bruijn graph, as in problem <a href="http://rosalind.info/problems/ba3e/">BA3E</a>) 
or a long sequence of DNA (which can be turned into a list of
k-mers and assembled into a de Bruijn graph, as in problem <a href="http://rosalind.info/problems/ba3d/">BA3D</a>).</p>
<p>If we are starting with a long string of DNA, we can run through the entire string
and extract k-mers using a sliding window. For a string of DNA of length <span class="math">\(d\)</span>, this procedure
will create <span class="math">\(d - k + 1\)</span> k-mers.</p>
<h2 id="directed-graph-representation-adjacency-list">Directed Graph Representation: Adjacency List</h2>
<p>The de Bruijn graph is a directed graph. To represent this
graph in memory, we utilize an adjacency list data structure.
An adjacency list is a key-value lookup table (implemented using
a hash map) wherein each <em>source vertex</em> in the graph is a key 
in the lookup table, and the corresponding value is a list of
all <em>destination vertices</em> (all vertices that have a directed
edge starting from the source vertex and ending at that vertex).</p>
<p>A Python dictionary can be used to implement the adjacency list
hash table. The dictionary keys are the source vertices (or rather,
their string labels), and the dictionary values are a list of 
destination vertices (a list of their string labels).</p>
<p>Thus, the graph <code>AA -&gt; BB -&gt; CC -&gt; DD</code> would be represented with
the hash table:</p>
<div class="highlight"><pre><span></span><span class="err">adjacency_list[&#39;AA&#39;] = [&#39;BB&#39;]</span>
<span class="err">adjacency_list[&#39;BB&#39;] = [&#39;CC&#39;]</span>
<span class="err">adjacency_list[&#39;CC&#39;] = [&#39;DD&#39;]</span>
</pre></div>


<p>(Notice from this example that the keys of the adjacency list
gives a list of <em>source vertices only</em>, to get all vertices we
need to look at the values of the adjacency list too.)</p>
<h2 id="a-quick-example">A Quick Example</h2>
<p>As a simple example, consider the de Bruijn graph formed from
the DNA string <code>AAGATTCTCTAC</code> and <span class="math">\(k = 4\)</span>.</p>
<p>This is first turned into a bag of <span class="math">\(d - k + 1 = 9\)</span> 
4-mers (our edges):</p>
<div class="highlight"><pre><span></span><span class="n">Sequence</span><span class="o">:</span>   <span class="n">AAGATTCTCTAC</span>
<span class="mi">4</span><span class="o">-</span><span class="n">mers</span><span class="o">:</span>     <span class="n">AAGA</span>
             <span class="n">AGAT</span>
              <span class="n">GATT</span>
               <span class="n">ATTC</span>
                <span class="n">TTCT</span>
                 <span class="n">TCTC</span>
                  <span class="n">CTCT</span>
                   <span class="n">TCTA</span>
                    <span class="n">CTAC</span>
</pre></div>


<p>Next, we also create a bag of <span class="math">\(d - k + 1 = 10\)</span> 
3-mers (vertices):</p>
<div class="highlight"><pre><span></span><span class="n">Sequence</span><span class="o">:</span>   <span class="n">AAGATTCTCTAC</span>
<span class="mi">3</span><span class="o">-</span><span class="n">mers</span><span class="o">:</span>     <span class="n">AAG</span>
             <span class="n">AGA</span>
              <span class="n">GAT</span>
               <span class="n">ATT</span>
                <span class="n">TTC</span>
                 <span class="n">TCT</span>
                  <span class="n">CTC</span>
                   <span class="n">TCT</span>
                    <span class="n">CTA</span>
                     <span class="n">TAC</span>
</pre></div>


<p>Now we can iterate over every 4-mer edge, find its
prefix 3-mer and suffix 3-mer, and create a corresponding
entry in the adjacency list hash table.</p>
<p>The list of edges looks like this:</p>
<div class="highlight"><pre><span></span><span class="err">AAG -&gt; AGA</span>
<span class="err">AGA -&gt; GAT</span>
<span class="err">ATT -&gt; TTC</span>
<span class="err">CTA -&gt; TAC</span>
<span class="err">CTC -&gt; TCT</span>
<span class="err">GAT -&gt; ATT</span>
<span class="err">TCT -&gt; CTA,CTC</span>
<span class="err">TTC -&gt; TCT</span>
</pre></div>


<p>The corresponding dictionary should look like this:</p>
<div class="highlight"><pre><span></span><span class="err">adjacency_list[&#39;AAG&#39;] = [&#39;AGA&#39;]</span>
<span class="err">adjacency_list[&#39;AGA&#39;] = [&#39;GAT&#39;]</span>
<span class="err">adjacency_list[&#39;ATT&#39;] = [&#39;TTC&#39;]</span>
<span class="err">adjacency_list[&#39;CTA&#39;] = [&#39;TAC&#39;]</span>
<span class="err">adjacency_list[&#39;CTC&#39;] = [&#39;TCT&#39;]</span>
<span class="err">adjacency_list[&#39;GAT&#39;] = [&#39;ATT&#39;]</span>
<span class="err">adjacency_list[&#39;TCT&#39;] = [&#39;CTA&#39;,&#39;CTC&#39;]</span>
<span class="err">adjacency_list[&#39;TTC&#39;] = [&#39;TCT&#39;]</span>
</pre></div>


<h2 id="python-vs-go">Python vs Go</h2>
<p>Now that we're ready to implement a directed graph object
and populate it using the data given in the problem, we 
have to make the difficult choice of what language we
want to use to implement the directed graph.</p>
<p>We have covered our use of the Go programming language 
for Rosalind.info problems before (we have previously 
covered recursion for Chapter 2 problems in 
<a href="https://charlesreid1.github.io/recursive-backtracking-in-go-for-bioinformatics-applications-1-counting-variations.html">Part 1</a>,
<a href="https://charlesreid1.github.io/recursive-backtracking-in-go-for-bioinformatics-applications-2-generating-variations.html">Part 2</a>,
and <a href="https://charlesreid1.github.io/recursive-backtracking-in-go-for-bioinformatics-applications-3-go-implementation-of-backtracking.html">Part 3</a>
of another post, and we also wrote <a href="https://charlesreid1.github.io/learning-bioinformatics-with-go-and-rosalind.html">this post</a>
on our impression of Go and its usefulness in
bioinformatics.</p>
<p>We are also implementing all of the solutions to the
Rosalind.info problems in our Go libarary, <a href="https://github.com/charlesreid1/go-rosalind">go-rosalind</a>
(see <a href="https://godoc.org/github.com/charlesreid1/go-rosalind/rosalind">corresponding documentation on godoc.org</a>).</p>
<p><strong>However,</strong> we have learned the hard way that Go requires
a lot of boilerplate code (boilerplate code that is necessary,
mind you, because all of that boilerplate will eventually
morph into something problem-specific).</p>
<p>This all means that Go is a very cumbersome language to use
to get an algorithm prototype up and running.</p>
<p>Python, on the other hand, is a very easy language for
prototyping and has plenty of handy built-in functions
and modules that make prototyping an algorithm far 
easier and faster than doing it in Go.</p>
<p>Our strategy, therefore, is to prototype our algorithm
and corresponding graph object in Python, get the
algorithm working and tested, then convert the code 
to Go when we are finished.</p>
<h2 id="directed-graph-class-python-implementation">Directed Graph Class: Python Implementation</h2>
<p>Note that while we could simply use the dictionary object
itself as the graph data structure, this is somewhat
inelegant, and we would like instead to define a class
to bundle related behavior and data together.</p>
<p>We implement the directed graph by defining an <code>AdjacencyGraph</code>
class. This is just a glorified wrapper around the ajacency
list dictionary, with some extra methods.</p>
<p>We start by defining the class (it inherits from <code>object</code> so
it has no parent type):</p>
<div class="highlight"><pre><span></span><span class="err">class AdjacencyGraph(object):</span>
<span class="err">    &quot;&quot;&quot;Directed graph stored using an adjacency list&quot;&quot;&quot;</span>
<span class="err">    def __init__(self):</span>
<span class="err">        &quot;&quot;&quot;Constructor&quot;&quot;&quot;</span>
<span class="err">        self.adj = {}</span>
<span class="err">        self.dfs_started = False</span>
</pre></div>


<p>The constructor just initializes an empty adjacency list dictionary.</p>
<p>We also define two built-in methods for convenience:
<code>__str__</code> for the string representation of the graph 
(so we can pass the graph object to <code>print()</code>), and
<code>__len__</code> for getting the number of (source) vertices 
on the graph.</p>
<div class="highlight"><pre><span></span><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__str__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">        </span><span class="ss">&quot;&quot;&quot;String representation&quot;&quot;&quot;</span><span class="w"></span>
<span class="w">        </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="n">sinks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="o">[</span><span class="n">source</span><span class="o">]</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">sink</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">sinks</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;%s -&gt; %s\n&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">sink</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">s</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="ss">&quot;&quot;</span><span class="p">.</span><span class="k">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__len__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">        </span><span class="ss">&quot;&quot;&quot;Number of vertices on graph&quot;&quot;&quot;</span><span class="w"></span>
<span class="w">        </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">set</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="n">s</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">sink</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="o">[</span><span class="n">k</span><span class="o">]</span><span class="err">:</span><span class="w"></span>
<span class="w">                </span><span class="n">s</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="n">sink</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
</pre></div>


<p>Next, we define some basic functionality useful for all graphs:</p>
<ul>
<li>Getting the in-degree and out-degree of a vertex</li>
</ul>
<div class="highlight"><pre><span></span><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">in_degree</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">u</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">        </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="n">sinks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="o">[</span><span class="n">v</span><span class="o">]</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">sinks</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="n">n</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">out_degree</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">u</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="o">[</span><span class="n">u</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
</pre></div>


<p>We also define a generator for creating vertices:</p>
<div class="highlight"><pre><span></span><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">vertices</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">        </span><span class="n">vertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">set</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="n">vertices</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="o">[</span><span class="n">k</span><span class="o">]</span><span class="err">:</span><span class="w"></span>
<span class="w">                </span><span class="n">vertices</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">vertices</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="n">yield</span><span class="w"> </span><span class="n">v</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">n_vertices</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">n_edges</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">        </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="k">try</span><span class="err">:</span><span class="w"></span>
<span class="w">                </span><span class="n">n</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="o">[</span><span class="n">source</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="ow">except</span><span class="err">:</span><span class="w"></span>
<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"></span>
<span class="w">                </span><span class="n">pass</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_neighbors</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">u</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">        </span><span class="ss">&quot;&quot;&quot;Get all neighbors of node u&quot;&quot;&quot;</span><span class="w"></span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">Note</span><span class="p">:</span><span class="w"> </span><span class="n">neighbors</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"></span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">sorted</span><span class="w"> </span><span class="k">order</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="o">[</span><span class="n">u</span><span class="o">]</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>
</pre></div>


<p>Finally, we add a method <code>add_edge()</code> that allows us
to create an edge from vertex u to vertex v (and add
the vertices to the graph if either do not yet exist
on the graph).</p>
<p>For convenience, we maintain the adjacency list values
(the list of destination vertices) in lexicographic
order.</p>
<div class="highlight"><pre><span></span><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_edge</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">        </span><span class="ss">&quot;&quot;&quot;Add an edge from u to v&quot;&quot;&quot;</span><span class="w"></span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">For</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="nl">vertex</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">Get</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="n">sink</span><span class="w"> </span><span class="n">list</span><span class="w"></span>
<span class="w">            </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="o">[</span><span class="n">u</span><span class="o">]</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">Append</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">it</span><span class="w"></span>
<span class="w">            </span><span class="n">t</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">Keep</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">sinks</span><span class="w"> </span><span class="n">sorted</span><span class="w"></span>
<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="p">(</span><span class="n">lexicographic</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">sorting</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">t</span><span class="p">.</span><span class="n">sort</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">Create</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span>
<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">sink</span><span class="w"></span>
<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="o">[</span><span class="n">u</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">Initialize</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">sinks</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">adj</span><span class="o">[</span><span class="n">u</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">v</span><span class="o">]</span><span class="w"></span>
</pre></div>


<p>Now, to assemble the de Bruijn graph, we can iterate
over every k-mer edge, form the prefix and suffix vertices,
and call the <code>add_edge()</code> function on the graph.</p>
<h1 id="checking-for-eulerian-paths-and-cycles">Checking for Eulerian Paths and Cycles</h1>
<p>To recap Eulerian paths versus Eulerian cycles (discussed in
<a href="https://charlesreid1.github.io/graphs-for-bioinformatics-part-1-de-bruijn-graphs-hamiltonian-paths-and-eulerian-paths.html">Part 1 of this post</a>:</p>
<ul>
<li>An Eulerian path is a path that visits every edge of a given graph exactly once.</li>
<li>An Eulerian cycle is an Eulerian path that begins and ends at the ''same vertex''.</li>
</ul>
<p>According to Steven Skienna's <u>Algorithm Design Handbook</u>,
there are two conditions that must be met for an Eulerian path or
cycle to exist. These conditions are different for undirected graphs
versus directed graphs.</p>
<p><strong>Undirected graphs:</strong> </p>
<ul>
<li>
<p>An undirected graph contains an Euler <strong>cycle</strong> iff
  (1) it is connected, and (2) each vertex is of even
  degree.</p>
</li>
<li>
<p>An undirected graph contains an Euler <strong>path</strong> iff (1)
  it is connected, and all but two vertices are of even
  degree. These two vertices will be the start and end
  vertices for the Eulerian path.</p>
</li>
</ul>
<p><strong>Directed graphs:</strong></p>
<ul>
<li>
<p>A directed graph contains an Euler cycle iff (1) it is
  strongly-connected, and (2) each vertex has the same
  in-degree as out-degree</p>
</li>
<li>
<p>A directed graph contains an Euler path iff (1) it is
  connected, and (2) all vertices except two (x,y) have
  the same in-degree as out-degree, and (x,y) are
  vertices with in-degree one less than and one more
  than out-degree</p>
</li>
</ul>
<h1 id="algorithm-building-blocks">Algorithm Building Blocks</h1>
<p>Algorithm to find Eulerian paths/cycles consists of several steps using several algorithms.</p>
<p>Undirected graphs are the simpler case; directed graphs are more complicated.</p>
<h2 id="depth-first-search">Depth First Search</h2>
<p>To perform a DFS on a directed graph, implement two functions:</p>
<ol>
<li>
<p>Write a DFS function that takes a graph as an input argument and that visits each node of the
   graph in a depth-first search.</p>
</li>
<li>
<p>Write a visitation function that takes a node as an input argument and that performs some action
   on the node. This visitation function is called by the DFS function on each node that it visits.</p>
</li>
</ol>
<h2 id="kosarajus-algorithm-connected-components">Kosaraju's Algorithm: Connected Components</h2>
<p>On an undirected graph, can use Fleury's Algorithm
to follow edges (classify edges as bridge or non-bridge,
then leave bridges for last).</p>
<p>On a directed graph, we have twice the amount of work:
we are not just checking that all vertices are reachable
from a given vertex, we are also checking that all vertices
can also reach that vertex.</p>
<h1 id="to-be-continued">To Be Continued...</h1>
<p>In the next part of this post, we will start with the slightly simpler case of finding an Euler cycle
(which has no start or end vertices). Then we will show how finding the Euler path is actually a special
case of finding the Euler cycle.</p>
<p>First, we will use <a href="https://charlesreid1.com/wiki/Graphs/Euler_Circuit#Directed_Graphs:_Hierholzer.27s_Algorithm">Hierholzer's
Algorithm</a>
to find Euler cycles (this is the simpler case). Order does not matter because it is a cycle;
Hierholzer's algorithm is used to find the Euler cycle.</p>
<p>Next, we will modify the above algorithm to find Euler paths. This requires keeping track of
the start and end candidate nodes. We verify only one each; we complete the cycle by adding an edge.
Once we find the cycle, we remove the edge. Finally, we rearrange the cycle to have the correct
start and end nodes.</p>
<p>Stay tuned for Part 3...</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script></div>

    </div>
</div>

<div class="v20"></div>

<div class="row">
    <div class="col-md-12" style="text-align: left;">

        <div class="tags">
            <p>Tags:&nbsp;&nbsp;&nbsp;
                    <a href="http://localhost:8000/tag/go.html">go</a>
                    &nbsp;&nbsp;
                    <a href="http://localhost:8000/tag/golang.html">golang</a>
                    &nbsp;&nbsp;
                    <a href="http://localhost:8000/tag/rosalind.html">rosalind</a>
                    &nbsp;&nbsp;
                    <a href="http://localhost:8000/tag/computational-biology.html">computational biology</a>
                    &nbsp;&nbsp;
                    <a href="http://localhost:8000/tag/bioinformatics.html">bioinformatics</a>
                    &nbsp;&nbsp;
                    <a href="http://localhost:8000/tag/euler.html">euler</a>
                    &nbsp;&nbsp;
                    <a href="http://localhost:8000/tag/recursion.html">recursion</a>
                    &nbsp;&nbsp;
                    <a href="http://localhost:8000/tag/backtracking.html">backtracking</a>
                    &nbsp;&nbsp;
                    <a href="http://localhost:8000/tag/graphs.html">graphs</a>
                    &nbsp;&nbsp;
                    <a href="http://localhost:8000/tag/algorithms.html">algorithms</a>
                    &nbsp;&nbsp;
                    <a href="http://localhost:8000/tag/hamiltonian.html">hamiltonian</a>
                    &nbsp;&nbsp;
                    <a href="http://localhost:8000/tag/eulerian.html">eulerian</a>
                    &nbsp;&nbsp;
        </div>

    </div>
</div>


<div class="v200"></div>

</div>


<script type="text/javascript" src="http://localhost:8000/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="http://localhost:8000/theme/js/bootstrap-3.3.4.js"></script>
<script type="text/javascript" src="http://localhost:8000/theme/js/d3-3.5.5.js"></script><script type="text/javascript" src="http://localhost:8000/theme/js/jquery-1.11.2.js"></script>
<script type="text/javascript" src="http://localhost:8000/theme/js/bootstrap-3.3.4.js"></script>

<footer id="contentinfo" class="body">
<p>&nbsp;</p>
<p>&nbsp;</p>
<center>
	<hr />
</center>
<p>&nbsp;</p>
<p style="text-align: center">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-terminal fa-stack-1x fa-inverse"></i>
    </span>
    Made from the command line with vim by 
    <a href="http://charlesreid1.com">charlesreid1</a><br />
    with help from <a href="https://getbootstrap.com/">Bootstrap</a> and <a href="http://getpelican.com">Pelican</a>.
</p>

<br />

<p style="text-align: center">
    <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
    <span class="fa-stack fa-lg">
        <i class="fa fa-square fa-stack-2x" style="color:#000;"></i>
        <i class="fa fa-creative-commons fa-stack-1x fa-inverse"></i>
    </span>
    </a>
    <br />
    Licensed under the <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 License</a>.
</p>

<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=11611748;
var sc_invisible=1;
var sc_security="9fcba820";
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>

<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="//c.statcounter.com/11611748/0/9fcba820/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</footer><!-- /#contentinfo -->
</body>
</html>